# –°—É—â–Ω–æ—Å—Ç–∏ –∏ –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å –ø—É–±–ª–∏—á–Ω—ã–º–∏/–ø—Ä–∏–≤–∞—Ç–Ω—ã–º–∏ —Å—Ç–∏–∫–µ—Ä–∞–º–∏

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Å—É—â–Ω–æ—Å—Ç–∏](#—Ç–∏–ø—ã-–¥–∞–Ω–Ω—ã—Ö-–∏-—Å—É—â–Ω–æ—Å—Ç–∏)
2. [API –º–µ—Ç–æ–¥—ã](#api-–º–µ—Ç–æ–¥—ã)
3. [–õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏](#–ª–æ–≥–∏–∫–∞-–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è-–≤–∏–¥–∏–º–æ—Å—Ç–∏)
4. [–õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏](#–ª–æ–≥–∏–∫–∞-–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è-–≤–∏–¥–∏–º–æ—Å—Ç–∏)
5. [–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –±—ç–∫–µ–Ω–¥–µ](#—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è-–Ω–∞-–±—ç–∫–µ–Ω–¥–µ)
6. [–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ UI](#–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ-–≤-ui)
7. [–°—Ç—Ä–∞–Ω–∏—Ü—ã –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#—Å—Ç—Ä–∞–Ω–∏—Ü—ã-–∏-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)

---

## –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Å—É—â–Ω–æ—Å—Ç–∏

### 1. **StickerSetResponse** (`miniapp/src/types/sticker.ts`)

–û—Å–Ω–æ–≤–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å –¥–ª—è —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–∞ —Å –ø–æ–ª—è–º–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏:

```typescript
export interface StickerSetResponse {
  id: number;
  name: string;
  title: string;
  createdAt: string;
  updatedAt: string;
  
  // üîê –ü–û–õ–Ø –í–ò–î–ò–ú–û–°–¢–ò (–º–æ–≥—É—Ç –±—ã—Ç—å –≤ —Ä–∞–∑–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏—è—Ö):
  visibility?: 'PUBLIC' | 'PRIVATE' | 'HIDDEN' | 'VISIBLE' | string;  // –°—Ç—Ä–æ–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  isPublished?: boolean;      // –ë—É–ª–µ–≤–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
  isPrivate?: boolean;        // –ë—É–ª–µ–≤–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏
  
  // –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∞
  userId?: number;
  authorId?: number;
  username?: string;
  firstName?: string;
  lastName?: string;
  avatarUrl?: string;
  
  // –õ–∞–π–∫–∏
  likesCount?: number;
  isLikedByCurrentUser?: boolean;
  
  // –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
  categories?: Array<{
    id: number;
    key: string;
    name: string;
    description: string;
    iconUrl?: string;
    displayOrder: number;
    isActive: boolean;
  }>;
  
  // Telegram –¥–∞–Ω–Ω—ã–µ
  telegramStickerSetInfo: TelegramStickerSetInfo;
}
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- API –º–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –ø–æ–ª–µ–π (`visibility`, `isPublished`, `isPrivate`)
- –î–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤—Å–µ —Ç—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø—É–±–ª–∏—á–Ω—ã–º, –µ—Å–ª–∏ —è–≤–Ω–æ –Ω–µ —É–∫–∞–∑–∞–Ω–æ –∏–Ω–æ–µ

---

### 2. **VisibilityState** (`miniapp/src/components/StickerSetDetail.tsx`)

–¢–∏–ø –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ –≤ UI:

```typescript
type VisibilityState = 'public' | 'private';
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –£–ø—Ä–æ—â–µ–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è UI (—Ç–æ–ª—å–∫–æ –¥–≤–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ `StickerSetDetail` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç—å—é

---

## API –º–µ—Ç–æ–¥—ã

### 1. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–æ–≤** (`miniapp/src/api/client.ts`)

#### `getStickerSets()` - –û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –¥–ª—è –≥–∞–ª–µ—Ä–µ–∏
```typescript
async getStickerSets(
  page: number = 0, 
  size: number = 20,
  options?: {
    categoryKeys?: string[];
    authorId?: number;
    userId?: number;
    hasAuthorOnly?: boolean;
    officialOnly?: boolean;
    likedOnly?: boolean;
    sort?: string;
    direction?: 'ASC' | 'DESC';
  }
): Promise<StickerSetListResponse>
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- **–ë—ç–∫–µ–Ω–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç** –ø–æ –≤–∏–¥–∏–º–æ—Å—Ç–∏:
  - –î–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: —Ç–æ–ª—å–∫–æ –ø—É–±–ª–∏—á–Ω—ã–µ (`isPublic = true`)
  - –î–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: –ø—É–±–ª–∏—á–Ω—ã–µ + —Å–≤–æ–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ
  - –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤: –≤—Å–µ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã

**Endpoint:** `GET /api/stickersets`

---

#### `getUserStickerSets()` - –°—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```typescript
async getUserStickerSets(
  userId: number,
  page: number = 0,
  size: number = 20,
  sort: 'createdAt' | 'title' | 'name' = 'createdAt',
  direction: 'ASC' | 'DESC' = 'DESC'
): Promise<StickerSetListResponse>
```

**–õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ:**
- –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç **–≤–ª–∞–¥–µ–ª–µ—Ü** (userId —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º) –∏–ª–∏ **–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä**:
  - –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è **–≤—Å–µ** —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–≤–∫–ª—é—á–∞—è –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ)
- –î–ª—è **–æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**:
  - –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ **–ø—É–±–ª–∏—á–Ω—ã–µ** —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã (`isPublic = true`)

**Endpoint:** `GET /api/stickersets?userId={userId}`

---

#### `getStickerSetsByAuthor()` - –°—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã –ø–æ –∞–≤—Ç–æ—Ä—É
```typescript
async getStickerSetsByAuthor(
  authorId: number,
  page: number = 0,
  size: number = 20,
  sort: string = 'createdAt',
  direction: 'ASC' | 'DESC' = 'DESC'
): Promise<StickerSetListResponse>
```

**–õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:**
- –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç **–≤–ª–∞–¥–µ–ª–µ—Ü** (authorId —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º) –∏–ª–∏ **–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä**:
  - –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è **–≤—Å–µ** —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã –∞–≤—Ç–æ—Ä–∞ (–≤–∫–ª—é—á–∞—è –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ)
- –î–ª—è **–æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**:
  - –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ **–ø—É–±–ª–∏—á–Ω—ã–µ** —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã (`isPublic = true`)

**Endpoint:** `GET /api/stickersets?authorId={authorId}`

---

### 2. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç—å—é**

#### `publishStickerSet()` - –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–∞
```typescript
async publishStickerSet(id: number): Promise<StickerSetResponse>
```

**–î–µ–π—Å—Ç–≤–∏–µ:**
- –î–µ–ª–∞–µ—Ç —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç **–ø—É–±–ª–∏—á–Ω—ã–º** (`isPublic = true`, `visibility = 'PUBLIC'`)
- –°—Ç–∏–∫–µ—Ä—Å–µ—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤–∏–¥–∏–º—ã–º –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≥–∞–ª–µ—Ä–µ–µ

**Endpoint:** `POST /api/stickersets/{id}/publish`

**–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:**
- –¢–æ–ª—å–∫–æ **–∞–≤—Ç–æ—Ä** —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–∞ –∏–ª–∏ **–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä**

---

#### `unpublishStickerSet()` - –°–∫—Ä—ã—Ç–∏–µ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–∞
```typescript
async unpublishStickerSet(id: number): Promise<StickerSetResponse>
```

**–î–µ–π—Å—Ç–≤–∏–µ:**
- –î–µ–ª–∞–µ—Ç —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç **–ø—Ä–∏–≤–∞—Ç–Ω—ã–º** (`isPublic = false`, `visibility = 'PRIVATE'`)
- –°—Ç–∏–∫–µ—Ä—Å–µ—Ç —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∏–∑ –ø—É–±–ª–∏—á–Ω–æ–π –≥–∞–ª–µ—Ä–µ–∏
- –û—Å—Ç–∞–µ—Ç—Å—è –≤–∏–¥–∏–º—ã–º —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∞ –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

**Endpoint:** `POST /api/stickersets/{id}/unpublish`

**–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:**
- –¢–æ–ª—å–∫–æ **–∞–≤—Ç–æ—Ä** —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–∞ –∏–ª–∏ **–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä**

---

## –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏

### –§—É–Ω–∫—Ü–∏—è `deriveVisibilityState()` (`miniapp/src/components/StickerSetDetail.tsx`)

–ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –ø–æ–ª–µ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏ –≤ –µ–¥–∏–Ω—ã–π `VisibilityState`:

```typescript
const deriveVisibilityState = (data?: StickerSetResponse | null): VisibilityState => {
  if (!data) return 'public';
  
  // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –ü–æ–ª–µ isPrivate (–±—É–ª–µ–≤–æ)
  const isPrivate = (data as any)?.isPrivate;
  if (typeof isPrivate === 'boolean') {
    return isPrivate ? 'private' : 'public';
  }

  // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –ü–æ–ª–µ isPublished (–±—É–ª–µ–≤–æ)
  const isPublished = (data as any)?.isPublished;
  if (typeof isPublished === 'boolean') {
    return isPublished ? 'public' : 'private';
  }

  // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –ü–æ–ª–µ visibility (—Å—Ç—Ä–æ–∫–∞)
  const visibility = (data as any)?.visibility ?? 
                    (data as any)?.status ?? 
                    (data as any)?.publishedStatus;
  if (typeof visibility === 'string') {
    const normalized = visibility.toLowerCase();
    
    // –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    if (['private', 'hidden', 'invisible'].includes(normalized)) {
      return 'private';
    }
    
    // –ü—É–±–ª–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    if (['public', 'visible', 'published'].includes(normalized)) {
      return 'public';
    }
  }

  // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é - –ø—É–±–ª–∏—á–Ω—ã–π
  return 'public';
};
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:**
1. `isPrivate` (boolean) - —Å–∞–º—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π
2. `isPublished` (boolean)
3. `visibility` (string) - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∞–∑–≤–∞–Ω–∏–π
4. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é - `'public'`

---

### –§—É–Ω–∫—Ü–∏—è `applyVisibilityToStickerSet()`

–ü—Ä–∏–º–µ–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –∫ –æ–±—ä–µ–∫—Ç—É —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–∞:

```typescript
const applyVisibilityToStickerSet = (
  data: StickerSetResponse, 
  visibility: VisibilityState
): StickerSetResponse => ({
  ...data,
  isPublished: visibility === 'public',
  isPrivate: visibility === 'private',
  visibility: visibility === 'public' ? 'PUBLIC' : 'PRIVATE'
});
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI (–ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ä–∞–∑—É)

---

## –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `StickerSetDetail` (`miniapp/src/components/StickerSetDetail.tsx`)

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

```typescript
const canToggleVisibility = (isAuthor || isAdmin) && Boolean(stickerSet.id);
```

**–£—Å–ª–æ–≤–∏—è:**
- `isAuthor` - —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–æ–º —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–∞
- `isAdmin` - —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–ª—è–µ—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
- `stickerSet.id` - —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (–Ω–µ –Ω–æ–≤—ã–π)

---

#### –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è `handleVisibilityToggle()`

```typescript
const handleVisibilityToggle = useCallback(
  async (event: React.MouseEvent<HTMLElement>) => {
    if (!canToggleVisibility || isVisibilityUpdating) {
      return;
    }

    const previousVisibility = draftVisibility;
    const next: VisibilityState = draftVisibility === 'public' ? 'private' : 'public';

    // 1. –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
    setDraftVisibility(next);
    setFullStickerSet((prev) =>
      prev ? applyVisibilityToStickerSet(prev, next) : applyVisibilityToStickerSet(stickerSet, next)
    );

    setIsVisibilityUpdating(true);
    
    try {
      // 2. –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
      const response =
        next === 'public'
          ? await apiClient.publishStickerSet(stickerSet.id)
          : await apiClient.unpublishStickerSet(stickerSet.id);

      // 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–∑ –æ—Ç–≤–µ—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞
      const responseVisibility = deriveVisibilityState(response);
      const finalVisibilityState = response ? responseVisibility : next;
      const finalData = response
        ? applyVisibilityToStickerSet(response, finalVisibilityState)
        : applyVisibilityToStickerSet(previousFull ?? stickerSet, finalVisibilityState);

      setFullStickerSet(finalData);
      setDraftVisibility(finalVisibilityState);

      // 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞
      stickerSetCache.set(stickerSet.id, {
        data: finalData,
        timestamp: Date.now(),
        ttl: CACHE_TTL
      });

      // 5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö —Å—Ç–æ—Ä–æ–≤
      useStickerStore.getState().updateStickerSet(stickerSet.id, finalData);
      useProfileStore.getState().updateUserStickerSet(stickerSet.id, finalData);

      onStickerSetUpdated?.(finalData);

      // 6. –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ
      setVisibilityInfoAnchor(anchor);
      visibilityInfoTimeoutRef.current = setTimeout(() => {
        setVisibilityInfoAnchor(null);
      }, 2800);
      
    } catch (error: any) {
      // 7. –û—Ç–∫–∞—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ
      console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–∞:', error);
      setFullStickerSet(previousFull ?? stickerSet);
      setDraftVisibility(previousVisibility);

      const message =
        error?.response?.data?.message ||
        error?.message ||
        '–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç—å —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.';

      window.alert(message);
    } finally {
      setIsVisibilityUpdating(false);
    }
  },
  [canToggleVisibility, draftVisibility, fullStickerSet, isVisibilityUpdating, stickerSet]
);
```

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤** - –º–æ–∂–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç—å
2. **–û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** - —Å—Ä–∞–∑—É –º–µ–Ω—è–µ–º UI
3. **API –∑–∞–ø—Ä–æ—Å** - –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
4. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –æ—Ç–≤–µ—Ç–∞** - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Å —Å–µ—Ä–≤–µ—Ä–æ–º
5. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à
6. **–ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–æ—Ä—ã** - –æ–±–Ω–æ–≤–ª—è–µ–º Zustand —Å—Ç–æ—Ä—ã
7. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –æ—Ç–∫–∞—Ç—ã–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–µ

---

## –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –±—ç–∫–µ–Ω–¥–µ

### –û–±—â–∞—è –ª–æ–≥–∏–∫–∞ (—Å–æ–≥–ª–∞—Å–Ω–æ OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏)

#### 1. **GET /api/stickersets** (–ì–ª–∞–≤–Ω–∞—è –≥–∞–ª–µ—Ä–µ—è)

**–î–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
- –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã —Å `isPublic = true`

**–î–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
- –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è:
  - –í—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã (`isPublic = true`)
  - –°–≤–æ–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã (–µ—Å–ª–∏ `userId` —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∞–≤—Ç–æ—Ä–æ–º)

**–î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:**
- –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤—Å–µ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã (–ø—É–±–ª–∏—á–Ω—ã–µ –∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ)

---

#### 2. **GET /api/stickersets?userId={userId}** (–°—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)

**–ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤–ª–∞–¥–µ–ª–µ—Ü (userId —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º) –∏–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:**
- –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è **–≤—Å–µ** —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–≤–∫–ª—é—á–∞—è –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ)

**–î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
- –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ **–ø—É–±–ª–∏—á–Ω—ã–µ** —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã (`isPublic = true`)

---

#### 3. **GET /api/stickersets?authorId={authorId}** (–°—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã –∞–≤—Ç–æ—Ä–∞)

**–ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤–ª–∞–¥–µ–ª–µ—Ü (authorId —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º) –∏–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:**
- –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è **–≤—Å–µ** —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã –∞–≤—Ç–æ—Ä–∞ (–≤–∫–ª—é—á–∞—è –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ)

**–î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
- –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ **–ø—É–±–ª–∏—á–Ω—ã–µ** —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã (`isPublic = true`)

---

## –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ UI

### 1. **–ò–∫–æ–Ω–∫–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏** (`StickerSetDetail.tsx`)

#### `EyePublishedIcon` - –ü—É–±–ª–∏—á–Ω—ã–π —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ `draftVisibility === 'public'`
- –ò–∫–æ–Ω–∫–∞ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –≥–ª–∞–∑–∞
- Tooltip: "–ü—É–±–ª–∏—á–Ω—ã–π –Ω–∞–±–æ—Ä"

#### `EyeUnpublishedIcon` - –ü—Ä–∏–≤–∞—Ç–Ω—ã–π —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ `draftVisibility === 'private'`
- –ò–∫–æ–Ω–∫–∞ –ø–µ—Ä–µ—á–µ—Ä–∫–Ω—É—Ç–æ–≥–æ –≥–ª–∞–∑–∞
- Tooltip: "–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –Ω–∞–±–æ—Ä"

---

### 2. **–ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è**

```typescript
{canToggleVisibility && (
  <Tooltip title={draftVisibility === 'public' ? '–ü—É–±–ª–∏—á–Ω—ã–π –Ω–∞–±–æ—Ä' : '–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –Ω–∞–±–æ—Ä'}>
    <IconButton
      aria-label="toggle-visibility"
      onClick={handleVisibilityToggle}
      disabled={isVisibilityUpdating}
      sx={{ color: draftVisibility === 'public' ? 'success.main' : 'text.secondary' }}
    >
      {draftVisibility === 'public' ? (
        <EyePublishedIcon sx={{ fontSize: 18 }} />
      ) : (
        <EyeUnpublishedIcon sx={{ fontSize: 18 }} />
      )}
    </IconButton>
  </Tooltip>
)}
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ö–Ω–æ–ø–∫–∞ –≤–∏–¥–Ω–∞ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `canToggleVisibility === true`
- –ë–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (`isVisibilityUpdating`)
- –¶–≤–µ—Ç –º–µ–Ω—è–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è

---

### 3. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ**

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è Popover —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π:
- –î–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏: "–°—Ç–∏–∫–µ—Ä—Å–µ—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω"
- –î–ª—è —Å–∫—Ä—ã—Ç–∏—è: "–°—Ç–∏–∫–µ—Ä—Å–µ—Ç —Å–∫—Ä—ã—Ç"

–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ 2.8 —Å–µ–∫—É–Ω–¥—ã.

---

## –°—Ç—Ä–∞–Ω–∏—Ü—ã –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. **GalleryPage** (`miniapp/src/pages/GalleryPage.tsx`)

**–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:**
- –ü—É–±–ª–∏—á–Ω—ã–µ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –°–≤–æ–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã (–µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω)

**–ú–µ—Ç–æ–¥ –∑–∞–≥—Ä—É–∑–∫–∏:**
```typescript
const response = await apiClient.getStickerSets(page, 20, {
  categoryKeys: selectedCategories,
  sort: sortByLikes ? 'likesCount' : 'createdAt',
  direction: 'DESC'
});
```

**–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è:**
- –ë—ç–∫–µ–Ω–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ –≤–∏–¥–∏–º–æ—Å—Ç–∏
- –§—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

---

### 2. **MyProfilePage** (`miniapp/src/pages/MyProfilePage.tsx`)

**–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:**
- **–í—Å–µ** —Å–≤–æ–∏ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã (–ø—É–±–ª–∏—á–Ω—ã–µ –∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ)
- –§–∏–ª—å—Ç—Ä –ø–æ –≤–∫–ª–∞–¥–∫–∞–º: "–ú–æ–∏" (published) –∏ "–ü–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è" (liked)

**–ú–µ—Ç–æ–¥ –∑–∞–≥—Ä—É–∑–∫–∏:**
```typescript
const response = await apiClient.getUserStickerSets(userIdParam, page, 20, 'createdAt', 'DESC');
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –≤—Å–µ —Å–≤–æ–∏ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –≤–∏–¥–∏–º–æ—Å—Ç–∏
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ `StickerSetDetail`

---

### 3. **ProfilePage** (`miniapp/src/pages/ProfilePage.tsx`)

**–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:**
- –ï—Å–ª–∏ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—à—å **—Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å**: –≤—Å–µ —Å–≤–æ–∏ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã (–ø—É–±–ª–∏—á–Ω—ã–µ –∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ)
- –ï—Å–ª–∏ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—à—å **—á—É–∂–æ–π –ø—Ä–æ—Ñ–∏–ª—å**: —Ç–æ–ª—å–∫–æ –ø—É–±–ª–∏—á–Ω—ã–µ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ú–µ—Ç–æ–¥ –∑–∞–≥—Ä—É–∑–∫–∏:**
```typescript
const response = await apiClient.getUserStickerSets(id, page, 20, sortField, 'DESC');
```

**–õ–æ–≥–∏–∫–∞:**
- –ë—ç–∫–µ–Ω–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ –ø—Ä–∞–≤–∞–º –¥–æ—Å—Ç—É–ø–∞
- –§—Ä–æ–Ω—Ç–µ–Ω–¥ –ø–æ–ª—É—á–∞–µ—Ç —É–∂–µ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫

---

### 4. **AuthorPage** (`miniapp/src/pages/AuthorPage.tsx`)

**–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:**
- –ï—Å–ª–∏ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—à—å **—Å–≤–æ–∏ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã –∫–∞–∫ –∞–≤—Ç–æ—Ä–∞**: –≤—Å–µ —Å–≤–æ–∏ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã (–ø—É–±–ª–∏—á–Ω—ã–µ –∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ)
- –ï—Å–ª–∏ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—à—å **—á—É–∂–∏–µ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã –∫–∞–∫ –∞–≤—Ç–æ—Ä–∞**: —Ç–æ–ª—å–∫–æ –ø—É–±–ª–∏—á–Ω—ã–µ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã —ç—Ç–æ–≥–æ –∞–≤—Ç–æ—Ä–∞

**–ú–µ—Ç–æ–¥ –∑–∞–≥—Ä—É–∑–∫–∏:**
```typescript
const response = await apiClient.getStickerSets(page, PAGE_SIZE, {
  authorId: authorId,
  sort: sortByLikes ? 'likesCount' : 'createdAt',
  direction: 'DESC'
});
```

**–õ–æ–≥–∏–∫–∞:**
- –ë—ç–∫–µ–Ω–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ –ø—Ä–∞–≤–∞–º –¥–æ—Å—Ç—É–ø–∞
- –§—Ä–æ–Ω—Ç–µ–Ω–¥ –ø–æ–ª—É—á–∞–µ—Ç —É–∂–µ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫

---

### 5. **StickerSetDetail** (`miniapp/src/components/StickerSetDetail.tsx`)

**–§—É–Ω–∫—Ü–∏–∏:**
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–µ
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ (–ø—É–±–ª–∏—á–Ω—ã–π/–ø—Ä–∏–≤–∞—Ç–Ω—ã–π)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
- –õ–∞–π–∫–∏

**–°–æ—Å—Ç–æ—è–Ω–∏—è:**
- `draftVisibility` - —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏ (–¥–ª—è UI)
- `isVisibilityUpdating` - —Ñ–ª–∞–≥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–±–ª–æ–∫–∏—Ä—É–µ—Ç –∫–Ω–æ–ø–∫—É)
- `visibilityInfoAnchor` - —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

---

## –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Å—Ç–æ—Ä—ã

### 1. **useStickerStore** (`miniapp/src/store/useStickerStore.ts`)

**–ú–µ—Ç–æ–¥—ã:**
- `updateStickerSet(id, updates)` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–∞ –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–º —Å—Ç–æ—Ä–µ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

---

### 2. **useProfileStore** (`miniapp/src/store/useProfileStore.ts`)

**–ú–µ—Ç–æ–¥—ã:**
- `updateUserStickerSet(id, updates)` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–∞ –≤ –ø—Ä–æ—Ñ–∏–ª–µ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

---

## –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–æ–≤ (`StickerSetDetail.tsx`)

```typescript
stickerSetCache.set(stickerSet.id, {
  data: finalData,
  timestamp: Date.now(),
  ttl: CACHE_TTL
});
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ö—ç—à –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ API
- TTL (Time To Live) –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫—ç—à–∞

---

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –ü—Ä–∏ –æ—à–∏–±–∫–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏:

1. **–û—Ç–∫–∞—Ç UI** - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
2. **–ü–æ–∫–∞–∑ —Å–æ–æ–±—â–µ–Ω–∏—è** - alert —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –æ—à–∏–±–∫–∏
3. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - console.error —Å –¥–µ—Ç–∞–ª—è–º–∏ –æ—à–∏–±–∫–∏

**–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏:**
- 403 Forbidden - –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ
- 404 Not Found - —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
- 500 Server Error - –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
- Network Error - –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é

---

## –†–µ–∑—é–º–µ

### –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:

1. **–¢—Ä–∏ –ø–æ–ª—è –≤–∏–¥–∏–º–æ—Å—Ç–∏** - `visibility`, `isPublished`, `isPrivate` (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
2. **–ï–¥–∏–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è** - `deriveVisibilityState()` –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –≤—Å–µ —Ñ–æ—Ä–º–∞—Ç—ã
3. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –±—ç–∫–µ–Ω–¥–µ** - —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –ø–æ–ª—É—á–∞–µ—Ç —É–∂–µ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
4. **–û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** - UI –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å—Ä–∞–∑—É, –∑–∞—Ç–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º
5. **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞** - —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä –∏–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç—å
6. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è** - –±—ç–∫–µ–Ω–¥ —Å–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç—ã –æ—Ç —á—É–∂–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
7. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ª–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## –î–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ—Ç–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å  ‚îÇ
‚îÇ  (UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îÇ 1. –ö–ª–∏–∫ –Ω–∞ –∫–Ω–æ–ø–∫—É –≤–∏–¥–∏–º–æ—Å—Ç–∏
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  StickerSetDetail       ‚îÇ
‚îÇ  handleVisibilityToggle ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îÇ 2. –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  setDraftVisibility()   ‚îÇ
‚îÇ  setFullStickerSet()     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îÇ 3. API –∑–∞–ø—Ä–æ—Å
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  apiClient.publish/     ‚îÇ
‚îÇ  unpublishStickerSet()  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îÇ 4. POST /api/stickersets/{id}/publish|unpublish
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      –ë—ç–∫–µ–Ω–¥ API         ‚îÇ
‚îÇ  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤        ‚îÇ
‚îÇ  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î        ‚îÇ
‚îÇ  - –í–æ–∑–≤—Ä–∞—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îÇ 5. –û—Ç–≤–µ—Ç —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è   ‚îÇ
‚îÇ  - setFullStickerSet()  ‚îÇ
‚îÇ  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞      ‚îÇ
‚îÇ  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–≤    ‚îÇ
‚îÇ  - –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

- `StickerSetDetail` ‚Üí `apiClient` ‚Üí `POST /api/stickersets/{id}/publish|unpublish`
- `GalleryPage` ‚Üí `apiClient.getStickerSets()` ‚Üí `GET /api/stickersets` (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –±—ç–∫–µ–Ω–¥–µ)
- `MyProfilePage` ‚Üí `apiClient.getUserStickerSets()` ‚Üí `GET /api/stickersets?userId={id}` (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –±—ç–∫–µ–Ω–¥–µ)
- `ProfilePage` ‚Üí `apiClient.getUserStickerSets()` ‚Üí `GET /api/stickersets?userId={id}` (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –±—ç–∫–µ–Ω–¥–µ)
- `AuthorPage` ‚Üí `apiClient.getStickerSets()` ‚Üí `GET /api/stickersets?authorId={id}` (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –±—ç–∫–µ–Ω–¥–µ)

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å—Ç–∏–∫–µ—Ä—Å–µ—Ç–æ–≤ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö:
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –±—ç–∫–µ–Ω–¥–µ
- **–£–¥–æ–±—Å—Ç–≤–æ** - –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ –ø–æ–ª–µ–π
- **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å—Ç–æ—Ä–æ–≤ –∏ –∫—ç—à–µ–π

