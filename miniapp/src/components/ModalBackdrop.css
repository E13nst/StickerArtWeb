/* Модалка: появление снизу. По умолчанию бэкдроп на весь экран. */
.modal-backdrop {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: var(--z-modal, 1000);
  background-color: var(--color-overlay-dark, rgba(0, 0, 0, 0.5));
  backdrop-filter: blur(15px);
  -webkit-backdrop-filter: blur(15px);
  display: flex;
  align-items: flex-end;
  justify-content: center;
  will-change: transform, opacity;
  transform: translateY(100%);
  opacity: 0;
  transition: transform 300ms ease, opacity 300ms ease;
}

/* Как sort-dropdown__backdrop: затемнение на весь viewport (inset: 0), только fade, без slide */
.modal-backdrop--keep-navbar {
  inset: 0;
  transform: none;
  will-change: opacity;
  display: block;
  animation: modal-backdrop-fade-in 0.25s ease-out;
}

.modal-backdrop--keep-navbar.modal-backdrop--no-blur {
  backdrop-filter: none;
  -webkit-backdrop-filter: none;
  background: rgba(0, 0, 0, 0.5);
}

.modal-backdrop--keep-navbar.modal-backdrop--open {
  transform: none;
  opacity: 1;
}

.modal-backdrop--keep-navbar.modal-backdrop--closing {
  transform: none;
  opacity: 0;
  transition: opacity 0.25s ease-out;
  animation: none;
  contain: paint;
}

@keyframes modal-backdrop-fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.modal-backdrop--no-blur:not(.modal-backdrop--keep-navbar) {
  backdrop-filter: none;
  -webkit-backdrop-filter: none;
}

.modal-backdrop--open {
  transform: translateY(0);
  opacity: 1;
}

/* Закрытие только свайпом вниз, без исчезновения (opacity не меняем) */
.modal-backdrop--closing:not(.modal-backdrop--keep-navbar) {
  transform: translateY(100%);
  opacity: 1;
  transition: transform 300ms ease;
  contain: paint;
}

/* При открытой модалке контент под ней не получает pointer events — клик по backdrop закрывает модалку и не открывает новый контент */
body.modal-open .stixly-page-container {
  pointer-events: none;
}

/* StickerPackModal рендерится в portal — поверх navbar без подъёма контента. Другие модалки при необходимости тоже в portal. */

.modal-backdrop-content {
  touch-action: pan-y;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: flex-end;
  justify-content: center;
}

/* При drag-dismiss: только slide вниз, без исчезновения */
.modal-backdrop--drag-dismissed {
  transition: none !important;
  transform: translateY(100%) !important;
  opacity: 1 !important;
}

/* keep-navbar при свайпе не получает --drag-dismissed, исчезает через --closing (плавный fade) */

/* Адаптивность для разных размеров экрана (blur только если не --no-blur) */
@media (max-width: 480px) {
  .modal-backdrop:not(.modal-backdrop--no-blur) {
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
  }
}

/* Поддержка для устройств без backdrop-filter */
@supports not (backdrop-filter: blur(15px)) {
  .modal-backdrop {
    background-color: rgba(0, 0, 0, 0.5);
  }
}
