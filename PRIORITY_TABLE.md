# ะัะพะณะพะฒะฐั ัะฐะฑะปะธัะฐ ะฟัะธะพัะธัะตัะพะฒ ะทะฐะณััะทะบะธ ััะธะบะตัะพะฒ

## ะกะธััะตะผะฐ ะฟัะธะพัะธัะตัะพะฒ (ะพั ะฒัััะตะณะพ ะบ ะฝะธะทัะตะผั)

| ะัะธะพัะธัะตั | ะะฝะฐัะตะฝะธะต | ะะฐะทะฒะฐะฝะธะต | ะะฟะธัะฐะฝะธะต | ะัะฟะพะปัะทะพะฒะฐะฝะธะต |
|-----------|----------|----------|----------|---------------|
| **TIER_0_MODAL** | 5 | ะะพะดะฐะปัะฝะพะต ะพะบะฝะพ | ะกัะธะบะตัั ะฒ ะผะพะดะฐะปัะฝะพะผ ะพะบะฝะต (ะฝะฐะธะฒัััะธะน) | โ **ะัะฟะพะปัะทัะตััั** - ััะธะบะตัั ะฒ ะผะพะดะฐะปัะฝะพะผ ะพะบะฝะต (StickerSetDetail) |
| **TIER_1_FIRST_6_PACKS** | 4 | ะะตัะฒัะต 6 ะฟะฐะบะพะฒ | ะะตัะฒัะต 6 ะฟะฐะบะพะฒ ะฝะฐ ัะบัะฐะฝะต | ะะตัะฒัะน ััะธะบะตั ะฟะตัะฒัั 6 ะฒะธะดะธะผัั ะฟะฐะบะพะฒ |
| **TIER_2_FIRST_IMAGE** | 3 | ะะตัะฒะพะต ะธะทะพะฑัะฐะถะตะฝะธะต | ะะตัะฒะพะต ะธะทะพะฑัะฐะถะตะฝะธะต ะบะฐะถะดะพะณะพ ะฟะฐะบะฐ | ะะตัะฒัะน ััะธะบะตั ะพััะฐะปัะฝัั ะฒะธะดะธะผัั ะฟะฐะบะพะฒ, 2-ะน/3-ะน ััะธะบะตัั ะฟะตัะฒัั 6 ะฒะธะดะธะผัั ะฟะฐะบะพะฒ |
| **TIER_3_ADDITIONAL** | 2 | ะะพะฟะพะปะฝะธัะตะปัะฝัะต | ะััะฐะปัะฝัะต ะธะทะพะฑัะฐะถะตะฝะธั | 2-ะน/3-ะน ััะธะบะตัั ะพััะฐะปัะฝัั ะฒะธะดะธะผัั ะฟะฐะบะพะฒ, ะฟะตัะฒัะน ััะธะบะตั ะฝะตะฒะธะดะธะผัั ะฟะฐะบะพะฒ |
| **TIER_4_BACKGROUND** | 1 | ะคะพะฝะพะฒัะต | ะคะพะฝะพะฒัะต ะฟะฐะบะธ | ะัะธ ัะพัะฐัะธะธ ะฒ ะฝะตะฒะธะดะธะผัั ะบะฐััะพัะบะฐั (ะผะธะฝะธะผะฐะปัะฝัะน ะฟัะธะพัะธัะตั) |

---

## ะะตัะฐะปัะฝะฐั ัะฐะฑะปะธัะฐ ะฟัะธะพัะธัะตัะพะฒ ะฟะพ ััะตะฝะฐัะธัะผ

### ๐ฑ ะะธะดะธะผัะต ะบะฐััะพัะบะธ (isNear = true, rootMargin: 200px)

| ะะพะทะธัะธั ะฟะฐะบะฐ | 1-ะน ััะธะบะตั | 2-ะน ััะธะบะตั | 3-ะน ััะธะบะตั | ะัะธ ัะพัะฐัะธะธ (ัะปะตะดัััะธะน) |
|--------------|------------|------------|------------|-------------------------|
| **ะะตัะฒัะต 6 ะฟะฐะบะพะฒ** | `TIER_1` (4) โญ ะะฐะบัะธะผะฐะปัะฝัะน | `TIER_2` (3) ๐ฅ ะััะพะบะธะน | `TIER_2` (3) ๐ฅ ะััะพะบะธะน | `TIER_2` (3) ๐ฅ ะััะพะบะธะน |
| **ะััะฐะปัะฝัะต ะฟะฐะบะธ** | `TIER_2` (3) ๐ฅ ะััะพะบะธะน | `TIER_3` (2) โก ะกัะตะดะฝะธะน | `TIER_3` (2) โก ะกัะตะดะฝะธะน | `TIER_3` (2) โก ะกัะตะดะฝะธะน |

### ๐ป ะะตะฒะธะดะธะผัะต ะบะฐััะพัะบะธ (isNear = false)

| ะะพะทะธัะธั ะฟะฐะบะฐ | 1-ะน ััะธะบะตั | 2-ะน ััะธะบะตั | 3-ะน ััะธะบะตั | ะัะธ ัะพัะฐัะธะธ (ัะปะตะดัััะธะน) |
|--------------|------------|------------|------------|-------------------------|
| **ะะตัะฒัะต 6 ะฟะฐะบะพะฒ** | `TIER_2` (3) โก ะกัะตะดะฝะธะน | โ **ะะต ะทะฐะณััะถะฐะตััั** | โ **ะะต ะทะฐะณััะถะฐะตััั** | `TIER_4` (1) ๐ ะะธะฝะธะผะฐะปัะฝัะน |
| **ะััะฐะปัะฝัะต ะฟะฐะบะธ** | `TIER_3` (2) ๐ ะะธะทะบะธะน | โ **ะะต ะทะฐะณััะถะฐะตััั** | โ **ะะต ะทะฐะณััะถะฐะตััั** | `TIER_4` (1) ๐ ะะธะฝะธะผะฐะปัะฝัะน |

---

## ะะธะทัะฐะปัะฝะฐั ััะตะผะฐ ะฟัะธะพัะธัะตัะพะฒ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    ะะะะะะซะ ะะะะขะะงะะ                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                               โ
โ  ะะตัะฒัะต 6 ะฟะฐะบะพะฒ:                                             โ
โ  โโโโโโโโโโโฌโโโโโโโโโโฌโโโโโโโโโโฌโโโโโโโโโโโโโโโ            โ
โ  โ 1-ะน: 4  โ 2-ะน: 3  โ 3-ะน: 3  โ ะะพัะฐัะธั: 3   โ            โ
โ  โ โญโญโญโญ โ ๐ฅ๐ฅ๐ฅ โ ๐ฅ๐ฅ๐ฅ โ ๐ฅ๐ฅ๐ฅ        โ            โ
โ  โโโโโโโโโโโดโโโโโโโโโโดโโโโโโโโโโดโโโโโโโโโโโโโโโ            โ
โ                                                               โ
โ  ะััะฐะปัะฝัะต ะฟะฐะบะธ:                                             โ
โ  โโโโโโโโโโโฌโโโโโโโโโโฌโโโโโโโโโโฌโโโโโโโโโโโโโโโ            โ
โ  โ 1-ะน: 3  โ 2-ะน: 2  โ 3-ะน: 2  โ ะะพัะฐัะธั: 2   โ            โ
โ  โ ๐ฅ๐ฅ๐ฅ โ โกโก    โ โกโก    โ โกโก          โ            โ
โ  โโโโโโโโโโโดโโโโโโโโโโดโโโโโโโโโโดโโโโโโโโโโโโโโโ            โ
โ                                                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                  ะะะะะะะะซะ ะะะะขะะงะะ                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                               โ
โ  ะะตัะฒัะต 6 ะฟะฐะบะพะฒ:                                             โ
โ  โโโโโโโโโโโฌโโโโโโโโโโฌโโโโโโโโโโฌโโโโโโโโโโโโโโโ            โ
โ  โ 1-ะน: 3   โ 2-ะน: โ  โ 3-ะน: โ โ ะะพัะฐัะธั: 1   โ            โ
โ  โ โกโก    โ         โ         โ ๐          โ            โ
โ  โโโโโโโโโโโดโโโโโโโโโโดโโโโโโโโโโดโโโโโโโโโโโโโโโ            โ
โ                                                               โ
โ  ะััะฐะปัะฝัะต ะฟะฐะบะธ:                                             โ
โ  โโโโโโโโโโโฌโโโโโโโโโโฌโโโโโโโโโโฌโโโโโโโโโโโโโโโ            โ
โ  โ 1-ะน: 2   โ 2-ะน: โ  โ 3-ะน: โ โ ะะพัะฐัะธั: 1   โ            โ
โ  โ ๐๐    โ         โ         โ ๐          โ            โ
โ  โโโโโโโโโโโดโโโโโโโโโโดโโโโโโโโโโดโโโโโโโโโโโโโโโ            โ
โ                                                               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ะฃะฟัะฐะฒะปะตะฝะธะต ะพัะตัะตะดัั ะทะฐะณััะทะบะธ

### ะะตะทะตัะฒะธัะพะฒะฐะฝะธะต ัะปะพัะพะฒ

- **ะัะตะณะพ ัะปะพัะพะฒ:** 10 (`maxConcurrency: 10`)
- **ะััะพะบะธะน ะฟัะธะพัะธัะตั (TIER_0-TIER_2):** ะะธะฝะธะผัะผ 6 ัะปะพัะพะฒ ัะตะทะตัะฒะธััะตััั
- **ะะธะทะบะธะน ะฟัะธะพัะธัะตั (TIER_3-TIER_4):** ะะฐะบัะธะผัะผ 4 ัะปะพัะฐ

### ะะพััะดะพะบ ะพะฑัะฐะฑะพัะบะธ

1. โ ะกะฝะฐัะฐะปะฐ ะพะฑัะฐะฑะฐััะฒะฐัััั ะฒััะพะบะพะฟัะธะพัะธัะตัะฝัะต ัะปะตะผะตะฝัั (TIER_0 โ TIER_1 โ TIER_2)
2. โณ ะะฐัะตะผ ะฝะธะทะบะพะฟัะธะพัะธัะตัะฝัะต (TIER_3 โ TIER_4), ะตัะปะธ ะตััั ัะฒะพะฑะพะดะฝัะต ัะปะพัั
3. ๐ซ ะะธะทะบะพะฟัะธะพัะธัะตัะฝัะต ะฝะต ะฑะปะพะบะธัััั ะฒััะพะบะพะฟัะธะพัะธัะตัะฝัะต

---

## ะะปััะตะฒัะต ะพะฟัะธะผะธะทะฐัะธะธ

### โ ะงัะพ ะทะฐะณััะถะฐะตััั ั ะผะฐะบัะธะผะฐะปัะฝัะผ ะฟัะธะพัะธัะตัะพะผ

- **ะะตัะฒัะน ััะธะบะตั ะฟะตัะฒัั 6 ะฒะธะดะธะผัั ะฟะฐะบะพะฒ** โ `TIER_1` (4) โญ
- **ะะตัะฒัะน ััะธะบะตั ะพััะฐะปัะฝัั ะฒะธะดะธะผัั ะฟะฐะบะพะฒ** โ `TIER_2` (3) ๐ฅ

### โ ะงัะพ ะะ ะทะฐะณััะถะฐะตััั (ัะบะพะฝะพะผะธั ะทะฐะฟัะพัะพะฒ)

- โ 2-ะน ะธ 3-ะน ััะธะบะตัั ะดะปั **ะฝะตะฒะธะดะธะผัั ะบะฐััะพัะตะบ** โ ะฝะต ะทะฐะณััะถะฐัััั ะฒะพะพะฑัะต
- โ ะญัะพ ัะผะตะฝััะฐะตั ะบะพะปะธัะตััะฒะพ ะทะฐะฟัะพัะพะฒ ะบ ััะธะบะตั-ะฟัะพัะตััะพัั ะฝะฐ **40-60%**

### โ ะงัะพ ะทะฐะณััะถะฐะตััั ั ะฒััะพะบะธะผ ะฟัะธะพัะธัะตัะพะผ ะดะปั ัะพัะฐัะธะธ

- **2-ะน ะธ 3-ะน ััะธะบะตัั ะฒะธะดะธะผัั ะบะฐััะพัะตะบ** โ `TIER_2` (ะฟะตัะฒัะต 6) ะธะปะธ `TIER_3` (ะพััะฐะปัะฝัะต)
- **ะกะปะตะดัััะธะน ััะธะบะตั ะฟัะธ ัะพัะฐัะธะธ** โ `TIER_2` ะธะปะธ `TIER_3` ะดะปั ะฒะธะดะธะผัั ะบะฐััะพัะตะบ

---

## ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### ะัะธะผะตั 1: ะะธะดะธะผะฐั ะบะฐััะพัะบะฐ (ะฟะตัะฒัะต 6 ะฟะฐะบะพะฒ)

```
ะะฐััะพัะบะฐ ะฒะธะดะฝะฐ ะฝะฐ ัะบัะฐะฝะต (isNear = true, index < 6)
โโ 1-ะน ััะธะบะตั: TIER_1 (4) โญ - ะทะฐะณััะถะฐะตััั ััะฐะทั ั ะผะฐะบัะธะผะฐะปัะฝัะผ ะฟัะธะพัะธัะตัะพะผ
โโ 2-ะน ััะธะบะตั: TIER_2 (3) ๐ฅ - ะทะฐะณััะถะฐะตััั ััะฐะทั ั ะฒััะพะบะธะผ ะฟัะธะพัะธัะตัะพะผ
โโ 3-ะน ััะธะบะตั: TIER_2 (3) ๐ฅ - ะทะฐะณััะถะฐะตััั ััะฐะทั ั ะฒััะพะบะธะผ ะฟัะธะพัะธัะตัะพะผ
โโ ะัะธ ัะพัะฐัะธะธ: TIER_2 (3) ๐ฅ - ัะปะตะดัััะธะน ััะธะบะตั ะทะฐะณััะถะฐะตััั ั ะฒััะพะบะธะผ ะฟัะธะพัะธัะตัะพะผ
```

### ะัะธะผะตั 2: ะะธะดะธะผะฐั ะบะฐััะพัะบะฐ (ะพััะฐะปัะฝัะต ะฟะฐะบะธ)

```
ะะฐััะพัะบะฐ ะฒะธะดะฝะฐ ะฝะฐ ัะบัะฐะฝะต (isNear = true, index >= 6)
โโ 1-ะน ััะธะบะตั: TIER_2 (3) ๐ฅ - ะทะฐะณััะถะฐะตััั ััะฐะทั ั ะฒััะพะบะธะผ ะฟัะธะพัะธัะตัะพะผ
โโ 2-ะน ััะธะบะตั: TIER_3 (2) โก - ะทะฐะณััะถะฐะตััั ััะฐะทั ัะพ ััะตะดะฝะธะผ ะฟัะธะพัะธัะตัะพะผ
โโ 3-ะน ััะธะบะตั: TIER_3 (2) โก - ะทะฐะณััะถะฐะตััั ััะฐะทั ัะพ ััะตะดะฝะธะผ ะฟัะธะพัะธัะตัะพะผ
โโ ะัะธ ัะพัะฐัะธะธ: TIER_3 (2) โก - ัะปะตะดัััะธะน ััะธะบะตั ะทะฐะณััะถะฐะตััั ัะพ ััะตะดะฝะธะผ ะฟัะธะพัะธัะตัะพะผ
```

### ะัะธะผะตั 3: ะะตะฒะธะดะธะผะฐั ะบะฐััะพัะบะฐ

```
ะะฐััะพัะบะฐ ะฝะต ะฒะธะดะฝะฐ (isNear = false)
โโ 1-ะน ััะธะบะตั: TIER_2 ะธะปะธ TIER_3 - ะทะฐะณััะถะฐะตััั ั ะฝะธะทะบะธะผ ะฟัะธะพัะธัะตัะพะผ
โโ 2-ะน ััะธะบะตั: โ ะะ ะะะะะฃะะะะขะกะฏ - ัะบะพะฝะพะผะธั ะทะฐะฟัะพัะพะฒ
โโ 3-ะน ััะธะบะตั: โ ะะ ะะะะะฃะะะะขะกะฏ - ัะบะพะฝะพะผะธั ะทะฐะฟัะพัะพะฒ
โโ ะัะธ ัะพัะฐัะธะธ: TIER_4 (1) ๐ - ัะพะปัะบะพ ะตัะปะธ ะฟะพะปัะทะพะฒะฐัะตะปั ะฟัะพะบัััะธั ะบ ะบะฐััะพัะบะต
```

---

## ะัะพะณะพะฒัะต ะผะตััะธะบะธ

| ะะตััะธะบะฐ | ะะพ ะพะฟัะธะผะธะทะฐัะธะธ | ะะพัะปะต ะพะฟัะธะผะธะทะฐัะธะธ | ะฃะปัััะตะฝะธะต |
|---------|----------------|-------------------|-----------|
| **ะะฐะฟัะพัั ะดะปั ะฝะตะฒะธะดะธะผัั ะบะฐััะพัะตะบ** | ะัะต ััะธะบะตัั ะทะฐะณััะถะฐะปะธัั | ะขะพะปัะบะพ 1-ะน ััะธะบะตั | **-66% ะทะฐะฟัะพัะพะฒ** |
| **ะัะธะพัะธัะตั ะฟะตัะฒะพะณะพ ััะธะบะตัะฐ (ะฒะธะดะธะผัะต)** | TIER_1 ะธะปะธ TIER_2 | TIER_1 (ะฟะตัะฒัะต 6) / TIER_2 (ะพััะฐะปัะฝัะต) | โ ะะฐะบัะธะผะฐะปัะฝัะน |
| **ะัะธะพัะธัะตั ััะธะบะตัะพะฒ ัะพัะฐัะธะธ (ะฒะธะดะธะผัะต)** | TIER_4 (1) | TIER_2 (3) ะธะปะธ TIER_3 (2) | **+200-300% ะฟัะธะพัะธัะตั** |
| **rootMargin** | 800px | 200px | **-75% ะทะพะฝะฐ ะฟัะตะดะทะฐะณััะทะบะธ** |
| **ะะฑัะตะต ัะผะตะฝััะตะฝะธะต ะทะฐะฟัะพัะพะฒ** | - | - | **~40-60%** |

---

## ะะตะณะตะฝะดะฐ

- โญ **ะะฐะบัะธะผะฐะปัะฝัะน ะฟัะธะพัะธัะตั** - ะทะฐะณััะถะฐะตััั ะฒ ะฟะตัะฒัั ะพัะตัะตะดั, ัะตะทะตัะฒะธัััััั ัะปะพัั
- ๐ฅ **ะััะพะบะธะน ะฟัะธะพัะธัะตั** - ะทะฐะณััะถะฐะตััั ะฑััััะพ, ะฟะพัะปะต ะผะฐะบัะธะผะฐะปัะฝะพะณะพ
- โก **ะกัะตะดะฝะธะน ะฟัะธะพัะธัะตั** - ะทะฐะณััะถะฐะตััั ะฟะพัะปะต ะฒััะพะบะพะณะพ, ะฝะพ ะดะพ ัะพะฝะพะฒะพะณะพ
- ๐ **ะะธะทะบะธะน ะฟัะธะพัะธัะตั** - ะทะฐะณััะถะฐะตััั ัะพะปัะบะพ ะตัะปะธ ะตััั ัะฒะพะฑะพะดะฝัะต ัะปะพัั
- ๐ **ะะธะฝะธะผะฐะปัะฝัะน ะฟัะธะพัะธัะตั** - ะทะฐะณััะถะฐะตััั ะฒ ะฟะพัะปะตะดะฝัั ะพัะตัะตะดั
- โ **ะะต ะทะฐะณััะถะฐะตััั** - ัะบะพะฝะพะผะธั ะทะฐะฟัะพัะพะฒ, ะทะฐะณััะทะธััั ัะพะปัะบะพ ะฟัะธ ะฝะตะพะฑัะพะดะธะผะพััะธ

---

## โ TIER_0_MODAL - ะัะฟะพะปัะทัะตััั ะดะปั ะผะพะดะฐะปัะฝะพะณะพ ะพะบะฝะฐ

**TIER_0_MODAL** ัะตะฟะตัั ะฐะบัะธะฒะฝะพ ะธัะฟะพะปัะทัะตััั ะฒ ัะธััะตะผะต ะฟัะธะพัะธัะตัะพะฒ ะดะปั ะทะฐะณััะทะบะธ ััะธะบะตัะพะฒ ะฒ ะผะพะดะฐะปัะฝะพะผ ะพะบะฝะต.

### ะะตะฐะปะธะทะฐัะธั ะผะพะดะฐะปัะฝะพะณะพ ะพะบะฝะฐ

ะ ะผะพะดะฐะปัะฝะพะผ ะพะบะฝะต (`StickerPackModal` โ `StickerSetDetail`) ััะธะบะตัั ะทะฐะณััะถะฐัััั ัะตัะตะท ััะฝะบัะธั `prefetchSticker()`, ะบะพัะพัะฐั ัะตะฟะตัั ะธัะฟะพะปัะทัะตั `imageLoader` ั ะฟัะธะพัะธัะตัะพะผ `TIER_0_MODAL`.

```typescript
// ะะตะฐะปะธะทะฐัะธั ะฒ StickerSetDetail.tsx
prefetchSticker(sticker.file_id, imageUrl, {
  isAnimated: Boolean(sticker.is_animated),
  isVideo: Boolean(sticker.is_video),
  markForGallery: true,
  priority: LoadPriority.TIER_0_MODAL // ะะฐะบัะธะผะฐะปัะฝัะน ะฟัะธะพัะธัะตั
})
```

### ะะดะต ะธัะฟะพะปัะทัะตััั TIER_0_MODAL?

1. **ะัะตะดะทะฐะณััะทะบะฐ ะฟะตัะฒัั 20 ััะธะบะตัะพะฒ** ะฒ ะผะพะดะฐะปัะฝะพะผ ะพะบะฝะต (`preloadLargeStickers`)
2. **ะะฐะณััะทะบะฐ ัะตะบััะตะณะพ ะฐะบัะธะฒะฝะพะณะพ ััะธะบะตัะฐ** ะฟัะธ ะฟะตัะตะบะปััะตะฝะธะธ ะฒ ะผะพะดะฐะปัะฝะพะผ ะพะบะฝะต

### ะัะตะธะผััะตััะฒะฐ

- โ **ะะฐะบัะธะผะฐะปัะฝัะน ะฟัะธะพัะธัะตั** - ััะธะบะตัั ะฒ ะผะพะดะฐะปัะฝะพะผ ะพะบะฝะต ะทะฐะณััะถะฐัััั ั ะฝะฐะธะฒัััะธะผ ะฟัะธะพัะธัะตัะพะผ (5)
- โ **ะะดะธะฝะฐั ัะธััะตะผะฐ ะฟัะธะพัะธัะตัะพะฒ** - ะฒัะต ะทะฐะณััะทะบะธ ัะตัะตะท sticker-processor ะธัะฟะพะปัะทััั `imageLoader`
- โ **ะัะธะพัะธัะตั ะฝะฐะด ะณะฐะปะตัะตะตะน** - ััะธะบะตัั ะฒ ะผะพะดะฐะปัะฝะพะผ ะพะบะฝะต ะทะฐะณััะถะฐัััั ะฑััััะตะต, ัะตะผ ะฒ ะณะฐะปะตัะตะต

