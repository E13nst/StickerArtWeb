# Анализ проекта Stixly для юридических документов

**Дата составления:** 25 января 2026  
**Версия проекта:** 1.1.0  
**Цель:** Подготовка информации для составления пользовательского соглашения и политики конфиденциальности в соответствии с требованиями законодательства РФ (152-ФЗ, требования к обработке ПДн)

---

## ЭТАП 1. ОБЩЕЕ ОПИСАНИЕ ПРОЕКТА

### Название проекта
- **Рабочее название:** Stixly
- **Публичное название:** Stixly
- **Описание:** React приложение для Telegram Mini App галереи стикеров

**Источник:** `README.md`, `package.json`

### Тип продукта
- **Тип:** Telegram Mini App (веб-приложение)
- **Технологии:** React + TypeScript + Vite
- **Формат распространения:** Веб-приложение, доступное через Telegram Web App

**Источник:** `README.md`, `ARCHITECTURE.md`

### Целевая аудитория
- **Основная аудитория:** Физические лица - пользователи Telegram
- **Возрастные ограничения:** Не определено (требуется уточнение)
- **География:** Глобальная (доступ через Telegram), но хостинг в РФ
- **Ограничения:** Требуется наличие аккаунта Telegram

**Источник:** Анализ функционала приложения

### Основное назначение сервиса
Сервис предоставляет пользователям Telegram возможность:
- Просматривать галерею стикерсетов
- Создавать и публиковать собственные стикерсеты
- Искать стикерсеты по категориям и названиям
- Ставить лайки стикерсетам
- Генерировать стикеры с помощью искусственного интеллекта
- Делать донаты авторам стикерсетов в криптовалюте TON
- Просматривать профили пользователей и авторов

**Источник:** `miniapp/src/api/client.ts`, `openapi.json`

### Ключевые пользовательские сценарии
1. **Просмотр галереи:** Пользователь открывает приложение и просматривает доступные стикерсеты
2. **Создание стикерсета:** Пользователь загружает существующий стикерсет из Telegram по ссылке
3. **Генерация стикера:** Пользователь оплачивает генерацию нового стикера через ИИ (Telegram Stars или внутренние очки)
4. **Лайки:** Пользователь ставит лайки понравившимся стикерсетам
5. **Донаты:** Пользователь отправляет донат автору стикерсета через TON Connect
6. **Поиск:** Пользователь ищет стикерсеты по названию или категориям
7. **Профиль:** Пользователь просматривает свой профиль и управляет своими стикерсетами

**Источник:** Анализ функционала приложения

### Платформа(ы) распространения
- **Основная платформа:** Telegram Web App (доступ через Telegram на всех платформах: iOS, Android, Desktop, Web)
- **Хостинг:** Amvera (Россия)
- **URL:** https://[your-domain].amvera.io/miniapp/
- **App Store / Google Play:** Не применимо (веб-приложение)

**Источник:** `ARCHITECTURE.md`, `README.md`

---

## ЭТАП 2. ФУНКЦИОНАЛ И ЛОГИКА РАБОТЫ

### Основные функции продукта

#### 1. Управление стикерсетами
- Просмотр списка стикерсетов с пагинацией
- Просмотр детальной информации о стикерсете
- Создание нового стикерсета по ссылке из Telegram
- Удаление стикерсета (владелец или администратор)
- Публикация/скрытие стикерсета из галереи
- Блокировка/разблокировка стикерсета (только администратор)
- Редактирование категорий стикерсета

**Источник:** `miniapp/src/api/client.ts`, `openapi.json`

#### 2. Система лайков
- Постановка лайка стикерсету
- Удаление лайка
- Просмотр лайкнутых стикерсетов
- Просмотр топа стикерсетов по лайкам

**Источник:** `miniapp/src/api/client.ts`, `miniapp/src/store/useLikesStore.ts`

#### 3. Поиск и фильтрация
- Поиск стикерсетов по названию
- Фильтрация по категориям
- Фильтрация по автору
- Фильтрация только лайкнутых стикерсетов
- Сортировка по различным параметрам (дата создания, количество лайков)

**Источник:** `miniapp/src/api/client.ts`

#### 4. Категории
- Просмотр всех активных категорий
- Привязка категорий к стикерсетам
- AI-подбор категорий для стикерсета (использует OpenAI ChatGPT)

**Источник:** `miniapp/src/api/client.ts`, `openapi.json`

#### 5. Генерация стикеров через ИИ
- Генерация изображения стикера по текстовому описанию (prompt)
- Выбор стиля из доступных пресетов
- Опция удаления фона
- Использование Telegram Stars или внутренних очков для генерации
- Сохранение сгенерированного изображения в стикерсет

**Источник:** `miniapp/src/pages/GeneratePage.tsx`, `miniapp/src/api/client.ts`

#### 6. Донаты авторам
- Подготовка транзакции доната
- Отправка доната через TON Connect
- Подтверждение транзакции

**Источник:** `miniapp/src/components/DonateModal.tsx`, `miniapp/src/api/client.ts`

#### 7. Профили пользователей
- Просмотр своего профиля
- Просмотр профилей других пользователей
- Просмотр стикерсетов пользователя
- Лидерборды пользователей и авторов
- Управление TON-кошельком

**Источник:** `miniapp/src/pages/ProfilePage.tsx`, `miniapp/src/pages/MyProfilePage.tsx`

#### 8. Свайп-режим
- Просмотр случайных стикерсетов
- Свайп-лайк и свайп-дизлайк
- Статистика свайпов
- Ограничения на количество свайпов в день

**Источник:** `miniapp/src/pages/SwipePage.tsx`, `miniapp/src/types/sticker.ts`

### Регистрация и авторизация

#### Способ авторизации
- **Метод:** Авторизация через Telegram Web App initData
- **Процесс:** 
  1. Пользователь открывает приложение в Telegram
  2. Telegram передает initData (подписанные данные с информацией о пользователе)
  3. Приложение отправляет initData на backend через заголовок `X-Telegram-Init-Data`
  4. Backend валидирует initData и создает/находит пользователя
- **Регистрация:** Автоматическая при первом использовании (не требуется отдельная регистрация)

**Источник:** `miniapp/src/hooks/useAuth.ts`, `miniapp/src/api/client.ts`, `openapi.json`

#### Используемые способы входа
- **Основной способ:** Telegram Web App initData (автоматически при открытии в Telegram)
- **Альтернативные способы:** Не предусмотрены
- **Гостевой доступ:** Частичный (просмотр без авторизации возможен, но функционал ограничен)

**Источник:** `miniapp/src/hooks/useAuth.ts`

### Роли пользователей

1. **ANONYMOUS (анонимный)**
   - Просмотр публичных стикерсетов (ограниченный функционал)
   - Не может создавать стикерсеты, ставить лайки, делать донаты

2. **USER (пользователь)**
   - Все функции анонимного пользователя
   - Создание и управление своими стикерсетами
   - Постановка лайков
   - Генерация стикеров (оплата через Telegram Stars или внутренние очки)
   - Донаты авторам
   - Управление профилем
   - Привязка TON-кошелька

3. **ADMIN (администратор)**
   - Все функции пользователя
   - Блокировка/разблокировка стикерсетов
   - Удаление любых стикерсетов
   - Управление категориями
   - Управление балансом внутренних очков пользователей
   - Установка автора стикерсета
   - Изменение официального статуса стикерсета

**Источник:** `openapi.json`, `miniapp/src/components/StickerSetActions.tsx`

### Ограничения доступа и функционала

#### Ограничения для неавторизованных пользователей
- Не могут создавать стикерсеты
- Не могут ставить лайки
- Не могут делать донаты
- Не могут генерировать стикеры
- Ограниченный просмотр (требуется уточнение)

#### Ограничения для авторизованных пользователей
- Могут управлять только своими стикерсетами (кроме администраторов)
- Генерация стикеров требует оплаты через Telegram Stars или наличия внутренних очков
- Свайпы ограничены дневным лимитом (требуется уточнение точных значений)

**Источник:** `miniapp/src/api/client.ts`, `miniapp/src/types/sticker.ts`

### Использование ИИ, алгоритмов, рекомендаций, автоматических решений

#### 1. OpenAI ChatGPT для подбора категорий
- **Функция:** AI-анализ названия стикерсета и предложение подходящих категорий
- **Endpoint:** `/api/categories/ai/suggest` и `/api/stickersets/{id}/ai/suggest-categories`
- **Параметры:** 
  - `apply` - применить категории автоматически или только показать предпросмотр
  - `minConfidence` - минимальный уровень уверенности (0.0-1.0)
- **Использование:** Пользователь может использовать AI для автоматического подбора категорий при создании/редактировании стикерсета

**Источник:** `openapi.json`, `miniapp/src/api/client.ts`

#### 2. Генерация изображений стикеров
- **Функция:** Генерация изображения стикера по текстовому описанию
- **Endpoint:** `/api/generation/generate`
- **Параметры:**
  - `prompt` - текстовое описание желаемого стикера
  - `stylePresetId` - ID пресета стиля (опционально)
  - `seed` - seed для воспроизводимости (опционально)
  - `removeBackground` - удаление фона (опционально)
- **Процесс:** Асинхронная генерация через систему задач (taskId)
- **Статусы:** PROCESSING_PROMPT, PENDING, GENERATING, REMOVING_BACKGROUND, COMPLETED, FAILED, TIMEOUT

**Источник:** `miniapp/src/pages/GeneratePage.tsx`, `miniapp/src/api/client.ts`

#### 3. Рекомендации (локальные алгоритмы)
- **Функция:** Умные рекомендации на основе поведения пользователя
- **Алгоритм:** Анализ лайков, просмотров, времени просмотра, истории поиска
- **Типы рекомендаций:** Похожие на лайкнутые, трендовые, по категориям
- **Реализация:** Локально на клиенте, не использует внешние сервисы

**Источник:** `miniapp/src/hooks/useSmartRecommendations.ts`

#### 4. Автоматические решения
- **Автоматическая регистрация:** При первом использовании создается профиль пользователя
- **Автоматическое обогащение данных:** Данные о стикерсетах автоматически получаются из Telegram Bot API
- **Автоматическое кэширование:** Стикеры кэшируются автоматически для ускорения загрузки

**Источник:** Анализ кода

---

## ЭТАП 3. ПЕРСОНАЛЬНЫЕ ДАННЫЕ И ИНФОРМАЦИЯ

### Какие данные собираются

#### 1. Персональные данные из Telegram

**Источник данных:** Telegram Web App initData

**Собираемые данные:**
- `id` (userId) - уникальный идентификатор пользователя Telegram (число)
- `username` - имя пользователя Telegram (строка, опционально)
- `first_name` - имя пользователя (строка)
- `last_name` - фамилия пользователя (строка, опционально)
- `language_code` - код языка пользователя (строка, например "ru", "en")
- `is_premium` - статус Telegram Premium (булево значение)
- `photo_url` - URL фотографии профиля (строка, опционально)

**Источник:** `miniapp/src/types/telegram.ts`, `miniapp/src/store/useProfileStore.ts`

#### 2. Данные профиля пользователя

**Структура профиля:**
- `userId` - Telegram ID пользователя
- `role` - роль пользователя (USER, ADMIN)
- `artBalance` - баланс внутренних очков (используется в коде для хранения баланса очков)
- `createdAt` - дата создания профиля
- `updatedAt` - дата последнего обновления
- `isBlocked` - статус блокировки (булево значение)

**Источник:** `miniapp/src/types/sticker.ts`, `miniapp/src/store/useProfileStore.ts`

#### 3. Технические данные

**Автоматически собираемые данные:**
- IP-адрес пользователя (передается через Nginx заголовки `X-Real-IP`, `X-Forwarded-For`)
- User-Agent браузера
- Информация об устройстве (через Telegram Web App: `platform`, `version`)
- Язык браузера (`navigator.language`)
- Размеры viewport
- initData (подписанные данные Telegram, содержащие информацию о пользователе и сессии)

**Источник:** `nginx.conf`, `miniapp/src/hooks/useTelegram.ts`

#### 4. Пользовательский контент

**Создаваемый пользователем контент:**
- Названия стикерсетов (title) - до 64 символов
- Имена стикерсетов (name) - уникальное имя для Telegram API
- Категории стикерсетов - привязка к существующим категориям
- Промпты для генерации стикеров - текстовые описания
- Лайки - информация о том, какие стикерсеты пользователь лайкнул
- Настройки видимости стикерсетов (публичный/приватный)

**Источник:** `miniapp/src/types/sticker.ts`, `miniapp/src/api/client.ts`

#### 5. Данные о транзакциях

**Донаты:**
- `stickerSetId` - ID стикерсета, которому делается донат
- `amountNano` - сумма доната в наноTON
- `intentId` - ID намерения транзакции
- `txHash` - хэш транзакции в блокчейне TON
- `fromWallet` - адрес кошелька отправителя
- `toWalletAddress` - адрес кошелька получателя

**Источник:** `miniapp/src/types/sticker.ts`, `miniapp/src/components/DonateModal.tsx`

#### 6. Данные о кошельке

**TON-кошелек:**
- `walletAddress` - адрес TON-кошелька
- `walletType` - тип кошелька (строка, опционально)
- `isActive` - статус активности кошелька
- `createdAt` - дата привязки кошелька

**Источник:** `miniapp/src/types/sticker.ts`, `miniapp/src/api/client.ts`

#### 7. Данные о поведении пользователя (локально)

**Хранятся в localStorage браузера:**
- Лайки пользователя (для оптимистичных обновлений UI)
- Тема оформления (light/dark)
- initData для тестирования (только в dev режиме)

**Источник:** `miniapp/src/store/useLikesStore.ts`, `miniapp/src/hooks/useTelegram.ts`, `miniapp/src/App.tsx`

#### 8. Кэшированные данные

**Service Worker кэш:**
- Изображения стикеров (URLs)
- Анимации стикеров (JSON данные)
- Видео стикеров (Blobs)

**Источник:** `miniapp/src/utils/cacheManager.ts`, `miniapp/public/sw.js`

### Цели сбора каждого типа данных

#### Персональные данные из Telegram
- **Цель:** Идентификация пользователя, персонализация интерфейса, отображение профиля
- **Основание:** Необходимо для функционирования сервиса, пользователь предоставляет данные через Telegram

#### Данные профиля
- **Цель:** Управление аккаунтом, отслеживание баланса ART, контроль доступа
- **Основание:** Необходимо для функционирования сервиса

#### Технические данные
- **Цель:** Обеспечение безопасности, предотвращение злоупотреблений, техническая поддержка, аналитика производительности
- **Основание:** Техническая необходимость для работы сервиса

#### Пользовательский контент
- **Цель:** Предоставление функционала создания и публикации стикерсетов
- **Основание:** Пользователь добровольно создает и публикует контент

#### Данные о транзакциях
- **Цель:** Обработка донатов авторам, подтверждение транзакций
- **Основание:** Необходимо для функционирования платежной системы

#### Данные о кошельке
- **Цель:** Привязка криптокошелька для донатов
- **Основание:** Пользователь добровольно привязывает кошелек

#### Данные о поведении (локально)
- **Цель:** Улучшение пользовательского опыта, кэширование для производительности
- **Основание:** Техническая необходимость для работы приложения

### Обязательность предоставления данных

#### Обязательные данные (для полного функционала)
- Telegram ID пользователя (из initData)
- Имя пользователя (first_name из Telegram)

#### Опциональные данные
- Фамилия (last_name)
- Username
- Фотография профиля
- Язык интерфейса
- TON-кошелек
- Категории стикерсетов

**Источник:** Анализ кода и API

### Источник данных

1. **Пользователь (через Telegram):** Все персональные данные из Telegram, пользовательский контент
2. **Telegram Bot API:** Данные о стикерах, стикерсетах, пользователях
3. **Автоматический сбор:** IP-адрес, технические данные браузера, данные о поведении
4. **Третьи лица:** OpenAI (для генерации), TON Connect (для платежей)

**Источник:** Анализ архитектуры

### Сроки хранения данных

**Не определено** - требуется уточнение у backend команды:
- Срок хранения персональных данных пользователей
- Срок хранения пользовательского контента (стикерсеты)
- Срок хранения данных о транзакциях
- Срок хранения логов и технических данных
- Политика архивирования

**Известные сроки кэширования:**
- Nginx кэш стикеров: 14 дней (настраивается в `nginx.conf`)
- Браузерный кэш стикеров: управляется браузером и Service Worker
- localStorage: до явного удаления пользователем или очистки браузера

**Источник:** `nginx.conf`, анализ кода

### Обезличивание / удаление / архивирование

#### Удаление данных пользователем
- Пользователь может удалить свои стикерсеты
- Пользователь может отвязать TON-кошелек
- Пользователь может очистить localStorage (через настройки браузера)

#### Удаление данных администратором
- Администратор может удалить любые стикерсеты
- Администратор может заблокировать пользователя (требуется уточнение влияния на данные)

#### Обезличивание
- **Не определено** - требуется уточнение политики обезличивания данных

#### Архивирование
- **Не определено** - требуется уточнение политики архивирования

**Источник:** `miniapp/src/api/client.ts`, `miniapp/src/components/StickerSetActions.tsx`

---

## ЭТАП 4. ОБРАБОТКА И ХРАНЕНИЕ ДАННЫХ

### Где хранятся данные

#### Backend сервер (основное хранилище)
- **Провайдер:** Amvera (Россия)
- **URL:** https://stickerartgallery-e13nst.amvera.io
- **Хранящиеся данные:**
  - Профили пользователей
  - Стикерсеты и их метаданные
  - Лайки
  - Категории
  - Транзакции донатов
  - Привязки кошельков
  - Балансы внутренних очков

**Источник:** `ARCHITECTURE.md`, `README.md`

#### Sticker Processor сервер
- **Провайдер:** Amvera (Россия)
- **URL:** https://sticker-processor-e13nst.amvera.io
- **Функция:** Загрузка и обработка файлов стикеров из Telegram Bot API
- **Хранящиеся данные:** Кэш файлов стикеров (требуется уточнение срока хранения)

**Источник:** `ARCHITECTURE.md`

#### Frontend сервер (Nginx)
- **Провайдер:** Amvera (Россия)
- **Функция:** Раздача статики и проксирование запросов
- **Хранящиеся данные:**
  - Кэш стикеров в `/data/cache/nginx/stickers` (14 дней, максимум 5GB)
  - Логи доступа и ошибок

**Источник:** `nginx.conf`, `docker-entrypoint.sh`, `ARCHITECTURE.md`

#### Браузер пользователя
- **localStorage:**
  - Лайки пользователя (для оптимистичных обновлений)
  - Тема оформления
  - Версия storage (для миграций)
  - initData для тестирования (только в dev режиме)
- **Service Worker Cache:**
  - Изображения стикеров
  - Анимации стикеров
  - Видео стикеров
- **Session Storage:** Не используется явно

**Источник:** `miniapp/src/store/useLikesStore.ts`, `miniapp/src/utils/cacheManager.ts`, `miniapp/src/App.tsx`

### Используются ли зарубежные сервисы

#### OpenAI (США)
- **Использование:** 
  - Подбор категорий для стикерсетов через ChatGPT API
  - Генерация изображений стикеров
- **Передаваемые данные:**
  - Только текстовые данные: названия стикерсетов (для подбора категорий), текстовые промпты для генерации изображений, параметры стиля и генерации
  - **Важно:** Персональные данные пользователей НЕ передаются в OpenAI, передаются только текстовые строки без привязки к пользователю
- **Трансграничная передача:** Да (текстовые данные передаются в США)
- **Требуется API ключ:** OPENAI_API_KEY (на backend)

**Источник:** `openapi.json`, `miniapp/src/api/client.ts`

#### Telegram Bot API
- **Использование:** Получение данных о стикерах, стикерсетах, пользователях
- **Передаваемые данные:** Запросы с file_id, именем стикерсета, user_id
- **Трансграничная передача:** Требуется уточнение (Telegram может использовать серверы за пределами РФ)
- **Примечание:** Backend делает запросы к Telegram Bot API

**Источник:** `ARCHITECTURE.md`, анализ функционала

#### TON Connect / TON Blockchain
- **Использование:** Интеграция для донатов в криптовалюте TON
- **Передаваемые данные:** Адреса кошельков, суммы транзакций, хэши транзакций
- **Трансграничная передача:** Да (блокчейн TON децентрализован)
- **Примечание:** Транзакции происходят напрямую между кошельками пользователей

**Источник:** `miniapp/src/components/DonateModal.tsx`, `miniapp/src/hooks/useWallet.ts`

### Есть ли трансграничная передача данных

**Да, трансграничная передача данных происходит:**

1. **OpenAI (США):**
   - Только текстовые данные: названия стикерсетов, промпты для генерации, параметры генерации
   - **Важно:** Персональные данные пользователей НЕ передаются в OpenAI

2. **TON Blockchain:**
   - Адреса кошельков
   - Данные транзакций

3. **Telegram Bot API:**
   - Требуется уточнение расположения серверов Telegram

**Источник:** Анализ кода и интеграций

### Используемые меры защиты данных

#### Технические меры (из кода)
- HTTPS для всех соединений
- Валидация initData на backend (проверка подписи Telegram)
- CORS заголовки для контроля доступа
- Nginx как reverse proxy с SSL
- Изоляция данных пользователей через авторизацию

**Источник:** `nginx.conf`, `ARCHITECTURE.md`, анализ кода

#### Меры защиты (требуется уточнение)
- Шифрование данных в базе данных
- Резервное копирование
- Мониторинг безопасности
- Политика доступа к данным
- Инцидент-менеджмент

**Источник:** Требуется уточнение у backend команды

### Кто имеет доступ к данным внутри команды

**Не определено** - требуется уточнение:
- Список лиц, имеющих доступ к персональным данным
- Разграничение доступа по ролям
- Логирование доступа к данным
- Соглашения о неразглашении

**Известно из кода:**
- Администраторы имеют расширенный доступ через роль ADMIN
- Обычные пользователи имеют доступ только к своим данным

**Источник:** `openapi.json`, анализ прав доступа

---

## ЭТАП 5. ВЗАИМОДЕЙСТВИЕ С ТРЕТЬИМИ ЛИЦАМИ

### Используемые сторонние сервисы

#### 1. Telegram Bot API
- **Назначение:** Получение данных о стикерах, стикерсетах, пользователях Telegram
- **Передаваемые данные:**
  - file_id стикеров (для загрузки файлов)
  - Имена стикерсетов (для получения информации)
  - Telegram user_id (для получения данных пользователей)
- **Цель использования:** Основной функционал приложения - работа со стикерами Telegram
- **Документация:** https://core.telegram.org/bots/api

**Источник:** `ARCHITECTURE.md`, анализ функционала

#### 2. OpenAI ChatGPT API
- **Назначение:** 
  - AI-подбор категорий для стикерсетов
  - Генерация изображений стикеров
- **Передаваемые данные:**
  - Только текстовые данные: названия стикерсетов (для анализа и подбора категорий), текстовые промпты для генерации изображений, параметры стиля и генерации
  - **Важно:** Персональные данные пользователей НЕ передаются, только анонимные текстовые строки
- **Цель использования:** Улучшение пользовательского опыта через AI-функции
- **Требуется API ключ:** OPENAI_API_KEY (хранится на backend)
- **Endpoint:** Используется через backend API (`/api/categories/ai/suggest`, `/api/generation/generate`)

**Источник:** `openapi.json`, `miniapp/src/api/client.ts`

#### 3. TON Connect
- **Назначение:** Интеграция криптокошельков для донатов авторам
- **Передаваемые данные:**
  - Адрес TON-кошелька пользователя
  - Данные транзакций (суммы, адреса получателей)
- **Цель использования:** Обработка донатов в криптовалюте TON
- **Библиотека:** `@tonconnect/ui-react` версия 2.0.0

**Источник:** `miniapp/src/components/DonateModal.tsx`, `package.json`, `miniapp/src/hooks/useWallet.ts`

#### 4. Amvera (хостинг)
- **Назначение:** Хостинг frontend, backend и sticker processor серверов
- **Передаваемые данные:** Все данные приложения хранятся на серверах Amvera
- **Цель использования:** Инфраструктура и хостинг
- **Локация:** Россия

**Источник:** `ARCHITECTURE.md`, `README.md`, `DEPLOY.md`

#### 5. Nginx (на Amvera)
- **Назначение:** Reverse proxy, раздача статики, кэширование
- **Передаваемые данные:** Проксирует все запросы между клиентом и backend
- **Цель использования:** Производительность и безопасность

**Источник:** `nginx.conf`, `ARCHITECTURE.md`

### Передаются ли данные этим сервисам

#### Telegram Bot API
- **Да:** file_id, имена стикерсетов, user_id передаются в запросах к API
- **Примечание:** Backend делает запросы к Telegram Bot API для получения данных

#### OpenAI
- **Да:** Только текстовые данные (названия стикерсетов и промпты) передаются в OpenAI API, персональные данные пользователей НЕ передаются
- **Трансграничная передача:** Да (текстовые данные уходят в США)

#### TON Connect / TON Blockchain
- **Да:** Адреса кошельков и данные транзакций передаются
- **Примечание:** Транзакции происходят напрямую в блокчейне

#### Amvera
- **Да:** Все данные приложения хранятся на серверах Amvera
- **Локация:** Россия

**Источник:** Анализ кода и архитектуры

### Для каких целей передаются данные

#### Telegram Bot API
- Получение информации о стикерах и стикерсетах
- Загрузка файлов стикеров
- Получение данных пользователей Telegram

#### OpenAI
- Анализ названий стикерсетов для подбора категорий (только текстовые данные)
- Генерация изображений по текстовым описаниям (только текстовые промпты)
- **Важно:** Персональные данные пользователей не передаются в OpenAI

#### TON Connect
- Обработка криптовалютных транзакций донатов
- Привязка кошельков пользователей

#### Amvera
- Хостинг и хранение всех данных приложения

**Источник:** Анализ функционала

### Есть ли партнерские программы или интеграции

**Не определено** - требуется уточнение:
- Партнерские программы с авторами стикерсетов
- Интеграции с другими сервисами
- Рекламные интеграции

**Известно:**
- Система донатов авторам стикерсетов (не партнерская программа, а функционал платформы)

**Источник:** Анализ кода

---

## ЭТАП 6. ПЛАТЕЖИ И МОНЕТИЗАЦИЯ

### Платный или бесплатный сервис

**Гибридная модель:**
- **Бесплатный базовый функционал:**
  - Просмотр стикерсетов
  - Создание стикерсетов
  - Постановка лайков
  - Поиск и фильтрация
  - Просмотр профилей
- **Платные функции:**
  - Генерация стикеров через ИИ (оплата через Telegram Stars или внутренние очки)
  - Возможны ограничения на свайпы (требуется уточнение)

**Источник:** Анализ функционала, `miniapp/src/pages/GeneratePage.tsx`

### Подписки, разовые платежи, встроенные покупки

#### Telegram Stars (звёзды)
- **Тип:** Встроенная валюта Telegram для покупок в Mini Apps
- **Назначение:** Оплата генерации стикеров через ИИ
- **Формат платежа:** Каждая генерация - отдельный платеж через Telegram Stars
- **Процесс:** Пользователь оплачивает каждую генерацию отдельно через встроенную систему Telegram Stars
- **Получатель платежа:** Счет самозанятого
- **Примечание:** Требуется уточнение необходимости и способа указания получателя платежа в политике конфиденциальности (обычно указывается в пользовательском соглашении или публичной оферте)

#### Внутренняя система очков
- **Тип:** Внутренняя виртуальная валюта (очки)
- **Назначение:** Альтернативный способ оплаты генерации стикеров
- **Способы получения очков:**
  - За приглашение пользователей (реферальная программа)
  - За использование приложения (активность, выполнение заданий)
- **Использование:** Очки можно тратить на генерацию стикеров через ИИ
- **Единица измерения:** Очки (целые числа)

**Источник:** `miniapp/src/pages/GeneratePage.tsx`, `miniapp/src/api/client.ts`, `miniapp/src/types/sticker.ts`

#### Донаты авторам
- **Тип:** Разовые платежи
- **Валюта:** TON (The Open Network) криптовалюта
- **Минимальная сумма:** 0.001 TON (1,000,000 наноTON)
- **Максимальная сумма:** 1000 TON (1,000,000,000,000 наноTON)
- **Preset суммы:** 1 TON, 5 TON, 10 TON
- **Процесс:**
  1. Пользователь выбирает сумму доната
  2. Backend подготавливает транзакцию (`/api/transactions/prepare`)
  3. Пользователь подтверждает транзакцию через TON Connect
  4. Backend подтверждает транзакцию (`/api/transactions/confirm`)

**Источник:** `miniapp/src/components/DonateModal.tsx`, `miniapp/src/api/client.ts`, `miniapp/src/types/sticker.ts`

### Используемые платежные системы

#### TON Connect
- **Тип:** Криптовалютная платежная система
- **Валюта:** TON (The Open Network)
- **Интеграция:** Через библиотеку `@tonconnect/ui-react`
- **Процесс:** Пользователь подключает TON-кошелек через TON Connect, транзакции происходят напрямую в блокчейне TON
- **Безопасность:** Транзакции подписываются приватным ключом пользователя в его кошельке

**Источник:** `miniapp/src/components/DonateModal.tsx`, `miniapp/src/hooks/useWallet.ts`, `package.json`

#### Telegram Stars
- **Тип:** Встроенная валюта Telegram
- **Хранение:** Управляется Telegram, не хранится на серверах приложения
- **Процесс:** Каждая генерация оплачивается отдельным платежом

#### Внутренняя система очков
- **Тип:** Внутренняя система виртуальной валюты
- **Хранение:** На backend сервере в профиле пользователя
- **Управление:** Начисление за приглашения и активность, использование на генерацию стикеров

**Источник:** `miniapp/src/api/client.ts`, `openapi.json`

### Возвраты, пробные периоды

#### Возвраты
- **Донаты в TON:** Не предусмотрены (криптовалютные транзакции необратимы)
- **Telegram Stars:** Требуется уточнение политики возврата (согласно правилам Telegram)
- **Внутренние очки:** Требуется уточнение политики возврата

#### Пробные периоды
- **Не определено** - требуется уточнение:
  - Пробные очки для новых пользователей
  - Бесплатные генерации для тестирования
  - Бесплатные генерации для тестирования

**Источник:** Требуется уточнение

### Виртуальные товары / цифровой контент

#### Генерируемые стикеры
- **Тип:** Цифровые изображения, сгенерированные через ИИ
- **Формат:** Изображения (формат определяется backend, возможно PNG, WebP)
- **Права:** Требуется уточнение прав на сгенерированный контент
- **Стоимость:** Оплачивается через Telegram Stars (каждая генерация отдельным платежом) или внутренними очками
- **Провайдер генерации:** Может быть на собственных серверах или на серверах стороннего провайдера (не обязательно указывать в политике конфиденциальности)

**Источник:** `miniapp/src/pages/GeneratePage.tsx`, `miniapp/src/api/client.ts`

#### Стикерсеты
- **Тип:** Коллекции стикеров из Telegram
- **Права:** Стикерсеты остаются в собственности пользователя, который их загрузил
- **Стоимость:** Бесплатно для создания и публикации

**Источник:** Анализ функционала

---

## ЭТАП 7. ПРАВА И ОБЯЗАННОСТИ ПОЛЬЗОВАТЕЛЕЙ

### Что пользователю разрешено

#### Базовые действия
- Просматривать публичные стикерсеты в галерее
- Искать стикерсеты по названию
- Фильтровать стикерсеты по категориям
- Просматривать профили других пользователей
- Просматривать лидерборды пользователей и авторов

#### Действия авторизованного пользователя
- Создавать стикерсеты (загружать существующие из Telegram)
- Публиковать/скрывать свои стикерсеты
- Удалять свои стикерсеты
- Редактировать категории своих стикерсетов
- Ставить и убирать лайки стикерсетам
- Просматривать список своих лайкнутых стикерсетов
- Генерировать стикеры через ИИ (оплата через Telegram Stars или внутренние очки)
- Делать донаты авторам стикерсетов в TON
- Привязывать и отвязывать TON-кошелек
- Просматривать свой профиль и баланс внутренних очков
- Использовать свайп-режим для просмотра случайных стикерсетов

**Источник:** `miniapp/src/api/client.ts`, `openapi.json`, анализ функционала

### Что запрещено

#### Явные запреты (из кода)
- Нарушение правил сообщества (может привести к блокировке стикерсета)
- Загрузка запрещенного контента (требуется уточнение конкретных правил)

#### Ограничения доступа
- Пользователь не может блокировать/разблокировать чужие стикерсеты
- Пользователь не может удалять чужие стикерсеты
- Пользователь не может изменять баланс внутренних очков (кроме администратора)
- Пользователь не может управлять категориями системы (кроме администратора)

**Источник:** `miniapp/src/components/StickerSetActions.tsx`, `openapi.json`

### Ответственность за нарушение правил

#### Блокировка стикерсетов
- **Кто может блокировать:** Только администратор
- **Причина блокировки:** Указывается администратором (поле `blockReason`)
- **Последствия:** Заблокированные стикерсеты не отображаются в галерее и профилях пользователей
- **Разблокировка:** Возможна администратором

**Источник:** `miniapp/src/components/StickerSetActions.tsx`, `miniapp/src/api/client.ts`, `openapi.json`

#### Блокировка пользователей
- **Не определено** - требуется уточнение:
  - Процедура блокировки пользователей
  - Причины блокировки
  - Последствия блокировки
  - Процедура разблокировки

**Источник:** В коде есть поле `isBlocked` в профиле, но процедура не определена

#### Удаление контента
- Пользователь может удалять свои стикерсеты
- Администратор может удалять любые стикерсеты
- **Последствия удаления:** Требуется уточнение (полное удаление или мягкое)

**Источник:** `miniapp/src/api/client.ts`, `openapi.json`

### Пользовательский контент и права на него

#### Стикерсеты
- **Права пользователя:** Пользователь сохраняет права на загруженные стикерсеты
- **Лицензия платформе:** Требуется уточнение (какие права предоставляет пользователь платформе)
- **Публикация:** Пользователь может делать стикерсет публичным или приватным
- **Удаление:** Пользователь может удалить свой стикерсет в любое время

**Источник:** Анализ функционала

#### Сгенерированные стикеры
- **Права:** Требуется уточнение прав на контент, сгенерированный через ИИ
- **Использование:** Пользователь может сохранять сгенерированные стикеры в свои стикерсеты

**Источник:** `miniapp/src/pages/GeneratePage.tsx`

### Блокировки, удаление аккаунтов

#### Блокировка стикерсетов
- **Процесс:** Администратор блокирует стикерсет с указанием причины
- **API:** `PUT /api/stickersets/{id}/block`
- **Восстановление:** `PUT /api/stickersets/{id}/unblock`

**Источник:** `miniapp/src/api/client.ts`, `openapi.json`

#### Удаление стикерсетов
- **Процесс:** Пользователь или администратор удаляет стикерсет
- **API:** `DELETE /api/stickersets/{id}`
- **Восстановление:** Требуется уточнение (возможно ли восстановление)

**Источник:** `miniapp/src/api/client.ts`, `openapi.json`

#### Удаление аккаунта
- **Не определено** - требуется уточнение:
  - Возможность удаления аккаунта пользователем
  - Процедура удаления
  - Что происходит с данными при удалении
  - Срок хранения данных после удаления

**Источник:** В коде нет явной функции удаления аккаунта

---

## ЭТАП 8. КОНТАКТЫ И ЮРИДИЧЕСКИЙ СТАТУС

### Кто является владельцем сервиса

**Не определено** - требуется уточнение:
- Физическое лицо
- Индивидуальный предприниматель (ИП)
- Юридическое лицо (ООО, АО и т.д.)

**Источник:** В коде и документации не найдено информации о владельце

### Наличие ОГРН / ИНН

**Не определено** - требуется уточнение:
- ОГРН (основной государственный регистрационный номер)
- ИНН (идентификационный номер налогоплательщика)
- Другие регистрационные данные

**Источник:** В коде и документации не найдено информации

### Контактные данные для обращений

#### Email поддержки
- **Email:** support@stickergallery.com
- **Источник:** `openapi.json` (поле `contact.email`)

#### Другие контакты
- **Не определено** - требуется уточнение:
  - Телефон поддержки
  - Адрес офиса
  - Другие способы связи

**Источник:** `openapi.json`

### Наличие службы поддержки

- **Email поддержки:** support@stickergallery.com
- **Функционал поддержки:** Требуется уточнение (только email или есть другие каналы)
- **Время работы:** Требуется уточнение
- **Языки поддержки:** Требуется уточнение

**Источник:** `openapi.json`

### Юрисдикция

- **Основная юрисдикция:** Российская Федерация
- **Обоснование:** 
  - Хостинг на Amvera (Россия)
  - Backend и frontend серверы расположены в России
- **Применимое право:** Законодательство Российской Федерации
- **Особенности:** 
  - Трансграничная передача данных в OpenAI (США) и TON Blockchain
  - Требуется уточнение соответствия требованиям 152-ФЗ при трансграничной передаче

**Источник:** `ARCHITECTURE.md`, `README.md`, `DEPLOY.md`

---

## ВОПРОСЫ, ТРЕБУЮЩИЕ УТОЧНЕНИЯ

### Критические вопросы для юридических документов

1. **Владелец сервиса:**
   - ФИО физического лица / Название ИП или юридического лица
   - ОГРН / ИНН
   - Адрес регистрации

2. **Сроки хранения данных:**
   - Срок хранения персональных данных пользователей
   - Срок хранения пользовательского контента (стикерсеты)
   - Срок хранения данных о транзакциях
   - Срок хранения логов и технических данных
   - Политика архивирования

3. **Политика удаления данных:**
   - Процедура удаления аккаунта пользователем
   - Что происходит с данными при удалении аккаунта
   - Срок полного удаления данных после запроса пользователя
   - Возможность восстановления удаленных данных

4. **Обезличивание данных:**
   - Используется ли обезличивание персональных данных
   - В каких случаях применяется
   - Методы обезличивания

5. **Блокировка пользователей:**
   - Процедура блокировки пользователей
   - Причины блокировки
   - Последствия блокировки (доступ к данным, возможность восстановления)
   - Уведомление пользователя о блокировке

6. **Права на контент:**
   - Какие права пользователь предоставляет платформе на загруженные стикерсеты
   - Права на контент, сгенерированный через ИИ
   - Лицензионные соглашения

7. **Платежи и возвраты:**
   - Способы пополнения баланса внутренних очков
   - Политика возврата внутренних очков
   - Условия использования донатов
   - Необходимость и способ указания получателя платежа (счет самозанятого) в политике конфиденциальности или пользовательском соглашении

8. **Трансграничная передача данных:**
   - Правовые основания для передачи данных в OpenAI (США)
   - Меры защиты при трансграничной передаче
   - Уведомление пользователей о трансграничной передаче

9. **Меры защиты данных:**
   - Шифрование данных в базе данных
   - Резервное копирование
   - Мониторинг безопасности
   - Политика доступа к данным сотрудников
   - Инцидент-менеджмент

10. **Доступ к данным:**
    - Список лиц, имеющих доступ к персональным данным
    - Разграничение доступа по ролям
    - Логирование доступа к данным
    - Соглашения о неразглашении

11. **Возрастные ограничения:**
    - Минимальный возраст пользователей
    - Ограничения для несовершеннолетних

12. **Правила использования:**
    - Детальные правила сообщества
    - Запрещенный контент
    - Процедура модерации

---

## ССЫЛКИ НА ПРИМЕРЫ ПОЛИТИК КОНФИДЕНЦИАЛЬНОСТИ

### Политики Telegram (обязательные для Mini Apps)
- **Privacy Policy Telegram:** https://telegram.org/privacy
- **Terms of Service Telegram:** https://telegram.org/tos

**Примечание:** Все Mini Apps интегрированы с Telegram, поэтому необходимо ссылаться на политики Telegram.

### Примеры похожих Mini Apps с оплатой через Stars или TON

#### Blum.io
- **Terms of Use:** https://www.blum.io/terms-of-use
- **Privacy Policy:** https://www.blum.io/privacy-policy

#### STKRHD
- **Terms:** https://prod.stkrhd.com/terms.pdf

#### Syntx.ai
- **Privacy Policy:** https://syntx.ai/privacy-policy
- **Public Offer:** https://syntx.ai/public-offer

#### Syntx Academy
- **Privacy Policy:** https://academy.syntx.ai/privacy-policy
- **Public Offer:** https://academy.syntx.ai/public-offer

**Примечание:** Эти проекты используют похожую модель монетизации (Stars или TON) и могут служить референсом для структуры политик.

---

## ИСТОЧНИКИ ИНФОРМАЦИИ

### Проанализированные файлы

1. `README.md` - общее описание проекта
2. `ARCHITECTURE.md` - архитектура и хостинг
3. `package.json` - зависимости и версия
4. `openapi.json` - полное описание API
5. `miniapp/src/api/client.ts` - все API методы
6. `miniapp/src/types/sticker.ts` - типы данных
7. `miniapp/src/types/telegram.ts` - данные Telegram
8. `miniapp/src/store/useProfileStore.ts` - профиль пользователя
9. `miniapp/src/hooks/useAuth.ts` - авторизация
10. `miniapp/src/hooks/useTelegram.ts` - интеграция с Telegram
11. `miniapp/src/components/DonateModal.tsx` - платежи
12. `miniapp/src/pages/GeneratePage.tsx` - генерация стикеров
13. `miniapp/src/components/StickerSetActions.tsx` - модерация
14. `miniapp/src/App.tsx` - использование localStorage
15. `miniapp/src/store/useLikesStore.ts` - система лайков
16. `miniapp/src/utils/cacheManager.ts` - кэширование
17. `nginx.conf` - конфигурация сервера
18. `Dockerfile` - инфраструктура
19. `docker-entrypoint.sh` - инициализация сервера
20. `DEPLOY.md` - информация о деплое

### Дата анализа
25 января 2026

### Версия проекта
1.1.0 (из `package.json`)

---

**Примечание:** Данный документ содержит техническую информацию о проекте, собранную из анализа кода и документации. Для подготовки окончательных юридических документов требуется уточнение указанных вопросов и консультация с юридическим специалистом.
