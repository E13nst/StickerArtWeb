# üíæ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–π

**–î–∞—Ç–∞:** 31 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–æ—Ñ–∏–ª—è.

---

## üéØ –¶–µ–ª–∏

1. ‚úÖ **–£–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API** - –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
2. ‚úÖ **–£—Å–∫–æ—Ä–∏—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é** - –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –∫—ç—à–∞
3. ‚úÖ **–£–ª—É—á—à–∏—Ç—å UX** - –Ω–µ—Ç "–º–∏–≥–∞–Ω–∏—è" –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è
4. ‚úÖ **–ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ** - –ø—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–µ–∑ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### 1. Store (useProfileStore)

```typescript
interface CachedProfile {
  userInfo: UserInfo;
  stickerSets: StickerSetResponse[];
  pagination: {
    currentPage: number;
    totalPages: number;
    totalElements: number;
  };
  timestamp: number; // –í—Ä–µ–º—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
}

interface ProfileState {
  profileCache: Map<number, CachedProfile>; // userId -> –¥–∞–Ω–Ω—ã–µ
  cacheTTL: number; // 5 –º–∏–Ω—É—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è
}
```

### 2. –ú–µ—Ç–æ–¥—ã –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

```typescript
// –ü–æ–ª—É—á–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å
getCachedProfile(userId: number): CachedProfile | null

// –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –≤ –∫—ç—à
setCachedProfile(
  userId: number,
  userInfo: UserInfo,
  stickerSets: StickerSetResponse[],
  pagination: {...}
): void

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –∫—ç—à–∞
isCacheValid(userId: number): boolean

// –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à (–æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –≤—Å–µ—Ö)
clearCache(userId?: number): void
```

---

## üìä –†–∞–±–æ—Ç–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

### –õ–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å
2. ‚¨áÔ∏è –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à
   ‚îÇ
   ‚îú‚îÄ ‚úÖ –ö—ç—à –≤–∞–ª–∏–¥–µ–Ω (< 5 –º–∏–Ω—É—Ç)
   ‚îÇ  ‚îî‚îÄ> üì¶ –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ –∫—ç—à–∞ (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ)
   ‚îÇ
   ‚îî‚îÄ ‚ùå –ö—ç—à –Ω–µ–≤–∞–ª–∏–¥–µ–Ω/–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
      ‚îî‚îÄ> üåê –ó–∞–≥—Ä—É–∂–∞–µ–º —Å —Å–µ—Ä–≤–µ—Ä–∞
          ‚îî‚îÄ> üíæ –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫—ç—à
```

### –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö

```typescript
Map<userId, {
  userInfo: { ... },
  stickerSets: [ ... ],
  pagination: { ... },
  timestamp: 1730370000000
}>
```

---

## üîß –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### 1. useProfileStore.ts

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**

```typescript
// –¢–∏–ø—ã
interface CachedProfile {
  userInfo: UserInfo;
  stickerSets: StickerSetResponse[];
  pagination: { currentPage: number; totalPages: number; totalElements: number };
  timestamp: number;
}

// –°–æ—Å—Ç–æ—è–Ω–∏–µ
profileCache: new Map<number, CachedProfile>()
cacheTTL: 5 * 60 * 1000 // 5 –º–∏–Ω—É—Ç

// –ú–µ—Ç–æ–¥—ã
getCachedProfile(userId)
setCachedProfile(userId, userInfo, stickerSets, pagination)
isCacheValid(userId)
clearCache(userId?)
```

**–†–∞–∑–º–µ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π:** ~50 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞

---

### 2. ProfilePage.tsx

**–ò–∑–º–µ–Ω–µ–Ω–æ:**

```typescript
// –î–æ
const loadUserProfile = async (id: number) => {
  // –í—Å–µ–≥–¥–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å —Å–µ—Ä–≤–µ—Ä–∞
  await loadUserInfo(id);
  await loadUserStickerSets(id);
}

// –ü–æ—Å–ª–µ
const loadUserProfile = async (id: number, forceReload = false) => {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à
  if (!forceReload && isCacheValid(id)) {
    const cached = getCachedProfile(id);
    if (cached) {
      // üì¶ –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ –∫—ç—à–∞
      setUserInfo(cached.userInfo);
      setUserStickerSets(cached.stickerSets);
      setPagination(...);
      return;
    }
  }
  
  // üåê –ó–∞–≥—Ä—É–∂–∞–µ–º —Å —Å–µ—Ä–≤–µ—Ä–∞
  await loadUserInfo(id);
  await loadUserStickerSets(id);
  
  // üíæ –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫—ç—à
  setCachedProfile(id, userInfo, stickerSets, pagination);
}
```

**–†–∞–∑–º–µ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π:** ~30 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞

---

### 3. MyProfilePage.tsx

–ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è —Å–≤–æ–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è.

**–†–∞–∑–º–µ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π:** ~30 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### TTL (Time To Live)

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: **5 –º–∏–Ω—É—Ç**

```typescript
cacheTTL: 5 * 60 * 1000 // 5 –º–∏–Ω—É—Ç
```

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ TTL:**

```typescript
// –í useProfileStore.ts
cacheTTL: 10 * 60 * 1000 // 10 –º–∏–Ω—É—Ç
```

### –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞

```typescript
// –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, –∏–≥–Ω–æ—Ä–∏—Ä—É—è –∫—ç—à
loadUserProfile(userId, true) // forceReload = true
```

---

## üéÆ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

–ö—ç—à —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ - –Ω–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

```typescript
// –ü–µ—Ä–≤–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –ø—Ä–æ—Ñ–∏–ª—è
<ProfilePage userId={123} /> 
// üåê –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å —Å–µ—Ä–≤–µ—Ä–∞ ‚Üí üíæ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –∫—ç—à

// –í—Ç–æ—Ä–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ (–≤ —Ç–µ—á–µ–Ω–∏–µ 5 –º–∏–Ω—É—Ç)
<ProfilePage userId={123} />
// üì¶ –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∏–∑ –∫—ç—à–∞ (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ!)

// –û—Ç–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 6 –º–∏–Ω—É—Ç
<ProfilePage userId={123} />
// üåê –ö—ç—à —É—Å—Ç–∞—Ä–µ–ª ‚Üí –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∑–∞–Ω–æ–≤–æ
```

### –†—É—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞

```typescript
const { clearCache } = useProfileStore();

// –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
clearCache(123);

// –û—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å –∫—ç—à
clearCache();
```

---

## üìà –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### 1. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–î–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è:**
```
–ö–∞–∂–¥—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –ø—Ä–æ—Ñ–∏–ª—å:
- 2 HTTP –∑–∞–ø—Ä–æ—Å–∞ (userInfo + stickerSets)
- ~500-1000ms –∑–∞–≥—Ä—É–∑–∫–∞
- –ü–æ–∫–∞–∑ Loading Spinner
```

**–° –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º:**
```
–ü–µ—Ä–≤—ã–π –ø–µ—Ä–µ—Ö–æ–¥:
- 2 HTTP –∑–∞–ø—Ä–æ—Å–∞
- ~500-1000ms –∑–∞–≥—Ä—É–∑–∫–∞

–ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã (–≤ —Ç–µ—á–µ–Ω–∏–µ 5 –º–∏–Ω):
- 0 HTTP –∑–∞–ø—Ä–æ—Å–æ–≤ ‚úÖ
- ~10-50ms –∑–∞–≥—Ä—É–∑–∫–∞ ‚úÖ
- –ù–µ—Ç Loading Spinner ‚úÖ
```

### 2. –≠–∫–æ–Ω–æ–º–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞

- ‚úÖ **–ú–µ–Ω—å—à–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API** - —Å–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ backend
- ‚úÖ **–ú–µ–Ω—å—à–µ —Ç—Ä–∞—Ñ–∏–∫–∞** - –≤–∞–∂–Ω–æ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- ‚úÖ **–ë—ã—Å—Ç—Ä–µ–µ —Ä–∞–±–æ—Ç–∞** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∂–¥–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∏

### 3. –£–ª—É—á—à–µ–Ω–Ω—ã–π UX

- ‚úÖ **–ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è** - –ø—Ä–æ—Ñ–∏–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É
- ‚úÖ **–ù–µ—Ç "–º–∏–≥–∞–Ω–∏—è"** - –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- ‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞** - –ø–æ–∑–∏—Ü–∏—è –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞

```typescript
// 1. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 123
navigate('/profile/123');

// –ö–æ–Ω—Å–æ–ª—å:
// üåê –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è 123 —Å —Å–µ—Ä–≤–µ—Ä–∞
// üåê API –∑–∞–ø—Ä–æ—Å: GET /api/profiles/123
// üåê API –∑–∞–ø—Ä–æ—Å: GET /api/stickersets/user/123
// üíæ –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 123 —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –∫—ç—à
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (–∫—ç—à –≤–∞–ª–∏–¥–µ–Ω)

```typescript
// 1. –û—Ç–∫—Ä—ã—Ç—å —Ç–æ—Ç –∂–µ –ø—Ä–æ—Ñ–∏–ª—å —Å–Ω–æ–≤–∞
navigate('/profile/123');

// –ö–æ–Ω—Å–æ–ª—å:
// ‚úÖ –ö—ç—à –ø—Ä–æ—Ñ–∏–ª—è 123 –∞–∫—Ç—É–∞–ª–µ–Ω (30—Å)
// üì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è 123 –∏–∑ –∫—ç—à–∞

// –†–µ–∑—É–ª—å—Ç–∞—Ç: –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞! ‚ö°
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –£—Å—Ç–∞—Ä–µ–≤—à–∏–π –∫—ç—à

```typescript
// 1. –ü–æ–¥–æ–∂–¥–∞—Ç—å 6 –º–∏–Ω—É—Ç
// 2. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
navigate('/profile/123');

// –ö–æ–Ω—Å–æ–ª—å:
// ‚è∞ –ö—ç—à –ø—Ä–æ—Ñ–∏–ª—è 123 —É—Å—Ç–∞—Ä–µ–ª (360—Å)
// üåê –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è 123 —Å —Å–µ—Ä–≤–µ—Ä–∞
// üíæ –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 123 —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –∫—ç—à
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –†–∞–∑–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏

```typescript
// 1. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ—Ñ–∏–ª—å 123
navigate('/profile/123'); // üåê –ó–∞–≥—Ä—É–∑–∫–∞ ‚Üí üíæ –ö—ç—à

// 2. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ—Ñ–∏–ª—å 456
navigate('/profile/456'); // üåê –ó–∞–≥—Ä—É–∑–∫–∞ ‚Üí üíæ –ö—ç—à

// 3. –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø—Ä–æ—Ñ–∏–ª—é 123
navigate('/profile/123'); // üì¶ –ò–∑ –∫—ç—à–∞!

// –ö—ç—à —Ö—Ä–∞–Ω–∏—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Ñ–∏–ª–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ ‚úÖ
```

---

## üîç –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –∫—ç—à–µ–º –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å:

```typescript
// –ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
üíæ –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 123 —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –∫—ç—à

// –ü—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏
‚úÖ –ö—ç—à –ø—Ä–æ—Ñ–∏–ª—è 123 –∞–∫—Ç—É–∞–ª–µ–Ω (45—Å)
‚è∞ –ö—ç—à –ø—Ä–æ—Ñ–∏–ª—è 123 —É—Å—Ç–∞—Ä–µ–ª (350—Å)

// –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
üì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è 123 –∏–∑ –∫—ç—à–∞
üåê –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è 123 —Å —Å–µ—Ä–≤–µ—Ä–∞

// –ü—Ä–∏ –æ—á–∏—Å—Ç–∫–µ
üßπ –ö—ç—à –ø—Ä–æ—Ñ–∏–ª—è 123 –æ—á–∏—â–µ–Ω
üßπ –í–µ—Å—å –∫—ç—à –ø—Ä–æ—Ñ–∏–ª–µ–π –æ—á–∏—â–µ–Ω
```

---

## üìù –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –•—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ø–∞–º—è—Ç–∏

–ö—ç—à —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ **Zustand store** (–≤ –ø–∞–º—è—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è):

‚úÖ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ
- –ù–µ –∑–∞–Ω–∏–º–∞–µ—Ç localStorage

‚ùå **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –û—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –ù–µ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–µ–Ω

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫—ç—à–∞

```typescript
Map<number, CachedProfile>

// –ü—Ä–∏–º–µ—Ä:
Map {
  123 => {
    userInfo: { id: 123, firstName: "John", ... },
    stickerSets: [...],
    pagination: { currentPage: 0, totalPages: 2, ... },
    timestamp: 1730370123456
  },
  456 => {
    userInfo: { id: 456, firstName: "Jane", ... },
    stickerSets: [...],
    pagination: { ... },
    timestamp: 1730370234567
  }
}
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏

```typescript
isCacheValid(userId) {
  const cached = profileCache.get(userId);
  if (!cached) return false;
  
  const age = Date.now() - cached.timestamp;
  return age < cacheTTL; // < 5 –º–∏–Ω—É—Ç
}
```

---

## üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

- ‚úÖ –ö—ç—à –≤ –ø–∞–º—è—Ç–∏ (Map)
- ‚úÖ TTL 5 –º–∏–Ω—É—Ç
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π

### –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **localStorage –∫—ç—à** (–ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–π):
   ```typescript
   // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏
   window.addEventListener('beforeunload', () => {
     localStorage.setItem('profileCache', JSON.stringify(cache));
   });
   ```

2. **LRU –∫—ç—à** (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞):
   ```typescript
   // –ú–∞–∫—Å–∏–º—É–º 10 –ø—Ä–æ—Ñ–∏–ª–µ–π –≤ –∫—ç—à–µ
   if (cache.size > 10) {
     // –£–¥–∞–ª–∏—Ç—å —Å–∞–º—ã–π —Å—Ç–∞—Ä—ã–π
   }
   ```

3. **–ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ –¥–µ–π—Å—Ç–≤–∏—è–º**:
   ```typescript
   // –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è
   updateProfile() ‚Üí clearCache(userId)
   ```

4. **Background refresh**:
   ```typescript
   // –û–±–Ω–æ–≤–ª—è—Ç—å –∫—ç—à –≤ —Ñ–æ–Ω–µ –ø–µ—Ä–µ–¥ –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º TTL
   if (age > 4 * 60 * 1000) { // –∑–∞ 1 –º–∏–Ω—É—Ç—É –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è
     loadInBackground();
   }
   ```

---

## üìö API Reference

### getCachedProfile

```typescript
getCachedProfile(userId: number): CachedProfile | null
```

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –∏–ª–∏ `null`.

**–ü—Ä–∏–º–µ—Ä:**
```typescript
const cached = getCachedProfile(123);
if (cached) {
  console.log('–ü—Ä–æ—Ñ–∏–ª—å –≤ –∫—ç—à–µ:', cached.userInfo.firstName);
}
```

---

### setCachedProfile

```typescript
setCachedProfile(
  userId: number,
  userInfo: UserInfo,
  stickerSets: StickerSetResponse[],
  pagination: { currentPage, totalPages, totalElements }
): void
```

–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –≤ –∫—ç—à —Å —Ç–µ–∫—É—â–∏–º timestamp.

**–ü—Ä–∏–º–µ—Ä:**
```typescript
setCachedProfile(123, userInfo, stickerSets, {
  currentPage: 0,
  totalPages: 2,
  totalElements: 15
});
```

---

### isCacheValid

```typescript
isCacheValid(userId: number): boolean
```

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –∞–∫—Ç—É–∞–ª–µ–Ω –ª–∏ –∫—ç—à (–≤–æ–∑—Ä–∞—Å—Ç < TTL).

**–ü—Ä–∏–º–µ—Ä:**
```typescript
if (isCacheValid(123)) {
  console.log('–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—ç—à');
} else {
  console.log('–ù—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å');
}
```

---

### clearCache

```typescript
clearCache(userId?: number): void
```

–û—á–∏—â–∞–µ—Ç –∫—ç—à –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –≤–µ—Å—å –∫—ç—à.

**–ü—Ä–∏–º–µ—Ä:**
```typescript
clearCache(123);  // –û—á–∏—Å—Ç–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å 123
clearCache();     // –û—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å –∫—ç—à
```

---

## üéì –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ

```typescript
// 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
loadUserProfile(userId); // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à

// 2. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
onRefresh={() => loadUserProfile(userId, true)}

// 3. –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ logout
logout() {
  clearCache();
}
```

### ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ

```typescript
// 1. –ù–µ –æ–±—Ö–æ–¥–∏—Ç—å –∫—ç—à –Ω–∞–ø—Ä—è–º—É—é
apiClient.getUserInfo(userId); // –ú–∏–Ω—É—è –∫—ç—à

// 2. –ù–µ —Ö—Ä–∞–Ω–∏—Ç—å sensitive –¥–∞–Ω–Ω—ã–µ
setCachedProfile(userId, { password: '...' }); // ‚ùå

// 3. –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—á–µ–Ω—å –±–æ–ª—å—à–æ–π TTL
cacheTTL: 24 * 60 * 60 * 1000; // 24 —á–∞—Å–∞ - —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ
```

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –†–∞–∑–º–µ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

- **Store:** +50 —Å—Ç—Ä–æ–∫
- **ProfilePage:** +30 —Å—Ç—Ä–æ–∫
- **MyProfilePage:** +30 —Å—Ç—Ä–æ–∫
- **–ò—Ç–æ–≥–æ:** ~110 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞

### –ü–æ–∫—Ä—ã—Ç–∏–µ

- ‚úÖ ProfilePage (–ø—Ä–æ—Å–º–æ—Ç—Ä —á—É–∂–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è)
- ‚úÖ MyProfilePage (–ø—Ä–æ—Å–º–æ—Ç—Ä —Å–≤–æ–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è)
- ‚ùå GalleryPage (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è - –ø—É–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

**–ò–∑–º–µ–Ω–µ–Ω—ã:**
- `miniapp/src/store/useProfileStore.ts` - –¥–æ–±–∞–≤–ª–µ–Ω –∫—ç—à
- `miniapp/src/pages/ProfilePage.tsx` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à
- `miniapp/src/pages/MyProfilePage.tsx` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- `PROFILE_CACHE_IMPLEMENTATION.md` (—ç—Ç–æ—Ç —Ñ–∞–π–ª)

---

## ‚úÖ Checklist

- [x] –î–æ–±–∞–≤–ª–µ–Ω –∫—ç—à –≤ useProfileStore
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –º–µ—Ç–æ–¥—ã –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- [x] –û–±–Ω–æ–≤–ª–µ–Ω ProfilePage
- [x] –û–±–Ω–æ–≤–ª–µ–Ω MyProfilePage
- [x] –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ä–∞–±–æ—Ç–∞ –∫—ç—à–∞
- [x] –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–î–∞—Ç–∞:** 31.10.2025  
**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:** ‚úÖ –î–∞












