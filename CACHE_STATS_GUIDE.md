# üìä –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø—Ä–æ—Å–º–æ—Ç—Ä—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫—ç—à–∞ Nginx

## –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
https://sticker-art-e13nst.amvera.io/cache-stats
```

–≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:
- ‚úÖ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —Å—Ç–∞—Ç—É—Å–∞ –∫—ç—à–∞ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Å—Ç–∏–∫–µ—Ä–æ–≤
- ‚úÖ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –ø—Ä–æ–≤–µ—Ä–∫–µ —á–µ—Ä–µ–∑ DevTools
- ‚úÖ –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —á–µ—Ä–µ–∑ curl
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–Ω–∞—á–µ–Ω–∏—è—Ö —Å—Ç–∞—Ç—É—Å–æ–≤ –∫—ç—à–∞

## –°–ø–æ—Å–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫—ç—à–∞

### 1. –ß–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://sticker-art-e13nst.amvera.io/cache-stats
2. –í–≤–µ–¥–∏—Ç–µ ID —Å—Ç–∏–∫–µ—Ä–∞ –≤ –ø–æ–ª–µ
3. –ù–∞–∂–º–∏—Ç–µ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å"
4. –£–≤–∏–¥–∏—Ç–µ —Å—Ç–∞—Ç—É—Å –∫—ç—à–∞ (HIT/MISS/BYPASS –∏ —Ç.–¥.)

### 2. –ß–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä DevTools

1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12 –∏–ª–∏ Cmd+Option+I)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Network**
3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç–∏–∫–µ—Ä (–∑–∞–ø—Ä–æ—Å –∫ `/stickers/...?file=true`)
4. –û—Ç–∫—Ä–æ–π—Ç–µ –∑–∞–ø—Ä–æ—Å ‚Üí –≤–∫–ª–∞–¥–∫–∞ **Headers**
5. –ù–∞–π–¥–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-Cache-Status`

### 3. –ß–µ—Ä–µ–∑ curl –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫—ç—à–∞
curl -I "https://sticker-art-e13nst.amvera.io/stickers/–í–ê–®_ID?file=true" | grep X-Cache-Status

# –í—Å–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
curl -I "https://sticker-art-e13nst.amvera.io/stickers/–í–ê–®_ID?file=true"
```

### 4. –ß–µ—Ä–µ–∑ –ª–æ–≥–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (Amvera Console)

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É:

```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –ª–æ–≥–∞ –∫—ç—à–∞
docker exec -it <container_name> tail -f /var/log/nginx/cache_stats.log

# –†–∞–∑–º–µ—Ä –∫—ç—à–∞ –Ω–∞ –¥–∏—Å–∫–µ
docker exec -it <container_name> du -sh /data/cache/nginx/stickers

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ –≤ –∫—ç—à–µ
docker exec -it <container_name> find /data/cache/nginx/stickers -type f | wc -l
```

## –ó–Ω–∞—á–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –∫—ç—à–∞

| –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ | –ß—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç |
|--------|----------|----------------|
| **HIT** | ‚úÖ –ü–æ–ø–∞–¥–∞–Ω–∏–µ –≤ –∫—ç—à | –û—Ç–≤–µ—Ç –≤–∑—è—Ç –∏–∑ –∫—ç—à–∞, –±—ã—Å—Ç—Ä–æ! |
| **MISS** | ‚ö†Ô∏è –ü—Ä–æ–º–∞—Ö –∫—ç—à–∞ | –ù–µ –Ω–∞–π–¥–µ–Ω–æ –≤ –∫—ç—à–µ, –∑–∞–ø—Ä–æ—Å –∫ –±—ç–∫–µ–Ω–¥—É |
| **BYPASS** | ‚è≠Ô∏è –ö—ç—à –ø—Ä–æ–ø—É—â–µ–Ω | –ö—ç—à –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (–Ω–µ—Ç `?file=true`) |
| **EXPIRED** | üîÑ –ö—ç—à —É—Å—Ç–∞—Ä–µ–ª | –ö—ç—à –∏—Å—Ç–µ–∫, –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è |
| **STALE** | üì¶ –£—Å—Ç–∞—Ä–µ–≤—à–∏–π –∫—ç—à | –û—Ç–¥–∞–Ω —É—Å—Ç–∞—Ä–µ–≤—à–∏–π –∫—ç—à (–±—ç–∫–µ–Ω–¥ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω) |
| **UPDATING** | üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ | –ö—ç—à –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ñ–æ–Ω–µ |

## –í–∞–∂–Ω–æ!

‚ö†Ô∏è **–ö—ç—à —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `?file=true` –∏–ª–∏ `?file=1`**

–ë–µ–∑ —ç—Ç–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –∏–º–µ—Ç—å —Å—Ç–∞—Ç—É—Å `BYPASS`.

–ü—Ä–∏–º–µ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ URL:
```
https://sticker-art-e13nst.amvera.io/stickers/CAACAgIAAxkBAAI...?file=true
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫—ç—à–∞

- **–í—Ä–µ–º—è –∂–∏–∑–Ω–∏:** 14 –¥–Ω–µ–π –¥–ª—è —É—Å–ø–µ—à–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ (200)
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä:** 5 GB
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** 2 –∑–∞–ø—Ä–æ—Å–∞ –ø–µ—Ä–µ–¥ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- **–ü—É—Ç—å –∫—ç—à–∞:** `/data/cache/nginx/stickers` (persistent storage)

## –ß—Ç–æ –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

1. ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—ç—à–∞ –≤ `/var/log/nginx/cache_stats.log`
2. ‚úÖ HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–ª—è —É–¥–æ–±–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
3. ‚úÖ –ó–∞–≥–æ–ª–æ–≤–æ–∫ `X-Cache-Status` –≤ –æ—Ç–≤–µ—Ç–∞—Ö (—É–∂–µ –±—ã–ª)

## –î–µ–ø–ª–æ–π

–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω—É–∂–Ω–æ:
1. –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
2. –ó–∞–¥–µ–ø–ª–æ–∏—Ç—å –Ω–∞ Amvera
3. –û—Ç–∫—Ä—ã—Ç—å https://sticker-art-e13nst.amvera.io/cache-stats

